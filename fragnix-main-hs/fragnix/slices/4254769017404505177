{"sliceID":4254769017404505177,"uses":[{"reference":{"otherSlice":9084010445215458515},"usedName":{"constructorName":{"identifier":"Logger"},"constructorTypeName":{"identifier":"Logger"}},"qualification":null},{"reference":{"otherSlice":6893936829500411324},"usedName":{"constructorName":{"identifier":"LogStr"},"constructorTypeName":{"identifier":"LogStr"}},"qualification":null},{"reference":{"builtinModule":"GHC.Classes"},"usedName":{"valueName":{"operator":">"}},"qualification":null},{"reference":{"otherSlice":5373247895451561196},"usedName":{"valueName":{"identifier":"flushLog"}},"qualification":null},{"reference":{"builtinModule":"Foreign.Marshal.Alloc"},"usedName":{"valueName":{"identifier":"allocaBytes"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"operator":"$"}},"qualification":null},{"reference":{"builtinModule":"Control.Concurrent.MVar"},"usedName":{"valueName":{"identifier":"withMVar"}},"qualification":null},{"reference":{"otherSlice":4629021591703842011},"usedName":{"valueName":{"identifier":"toBufIOWith"}},"qualification":null},{"reference":{"otherSlice":2083011172655175731},"usedName":{"valueName":{"identifier":"write"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"identifier":"otherwise"}},"qualification":null},{"reference":{"builtinModule":"Data.IORef"},"usedName":{"valueName":{"identifier":"atomicModifyIORef'"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"constructorName":{"identifier":"Nothing"},"constructorTypeName":{"identifier":"Maybe"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"identifier":"return"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"constructorName":{"identifier":"Just"},"constructorTypeName":{"identifier":"Maybe"}},"qualification":null},{"reference":{"otherSlice":7369405537109191145},"usedName":{"valueName":{"identifier":"writeLogStr"}},"qualification":null},{"reference":{"builtinModule":"GHC.Classes"},"usedName":{"valueName":{"operator":"<"}},"qualification":null},{"reference":{"builtinModule":"GHC.Num"},"usedName":{"valueName":{"operator":"+"}},"qualification":null},{"reference":{"builtinModule":"Data.Monoid"},"usedName":{"valueName":{"operator":"<>"}},"qualification":null},{"reference":{"otherSlice":787637585457186905},"usedName":{"typeName":{"identifier":"FD"}},"qualification":null},{"reference":{"otherSlice":9084010445215458515},"usedName":{"typeName":{"identifier":"Logger"}},"qualification":null},{"reference":{"otherSlice":6893936829500411324},"usedName":{"typeName":{"identifier":"LogStr"}},"qualification":null},{"reference":{"builtinModule":"GHC.Types"},"usedName":{"typeName":{"identifier":"IO"}},"qualification":null}],"fragment":["pushLog :: FD -> Logger -> LogStr -> IO ()","pushLog fd logger@(Logger mbuf size ref)\n  nlogmsg@(LogStr nlen nbuilder)\n  | nlen > size =\n    do flushLog fd logger\n       allocaBytes nlen $\n         \\ buf ->\n           withMVar mbuf $ \\ _ -> toBufIOWith buf nlen (write fd) nbuilder\n  | otherwise =\n    do mmsg <- atomicModifyIORef' ref checkBuf\n       case mmsg of\n           Nothing -> return ()\n           Just msg -> withMVar mbuf $ \\ buf -> writeLogStr fd buf size msg\n  where checkBuf ologmsg@(LogStr olen _)\n          | size < olen + nlen = (nlogmsg, Just ologmsg)\n          | otherwise = (ologmsg <> nlogmsg, Nothing)"],"instances":[],"language":{"extensions":["BangPatterns","MultiParamTypeClasses","NondecreasingIndentation","ExplicitForAll","PatternGuards"],"isInstance":false}}