{"sliceID":4533106591704167736,"uses":[{"reference":{"otherSlice":7492686854104684507},"usedName":{"constructorName":{"identifier":"SRequest"},"constructorTypeName":{"identifier":"SRequest"}},"qualification":null},{"reference":{"otherSlice":7843507088588387944},"usedName":{"valueName":{"identifier":"ask"}},"qualification":null},{"reference":{"builtinModule":"Control.Monad.IO.Class"},"usedName":{"valueName":{"identifier":"liftIO"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"operator":"$"}},"qualification":null},{"reference":{"builtinModule":"GHC.IORef"},"usedName":{"valueName":{"identifier":"newIORef"}},"qualification":null},{"reference":{"otherSlice":7656308987823753789},"usedName":{"valueName":{"identifier":"toChunks"}},"qualification":"L"},{"reference":{"otherSlice":9025559142516147699},"usedName":{"valueName":{"identifier":"requestBody"}},"qualification":null},{"reference":{"builtinModule":"Data.IORef"},"usedName":{"valueName":{"identifier":"atomicModifyIORef"}},"qualification":null},{"reference":{"otherSlice":7459617743278403755},"usedName":{"valueName":{"identifier":"empty"}},"qualification":"S"},{"reference":{"otherSlice":7169152895272538586},"usedName":{"valueName":{"identifier":"addCookiesToRequest"}},"qualification":null},{"reference":{"builtinModule":"GHC.Err"},"usedName":{"valueName":{"identifier":"error"}},"qualification":null},{"reference":{"otherSlice":3390914165584877492},"usedName":{"constructorName":{"identifier":"ResponseReceived"},"constructorTypeName":{"identifier":"ResponseReceived"}},"qualification":null},{"reference":{"otherSlice":4167997142201215002},"usedName":{"valueName":{"identifier":"runResponse"}},"qualification":null},{"reference":{"builtinModule":"GHC.IORef"},"usedName":{"valueName":{"identifier":"readIORef"}},"qualification":null},{"reference":{"otherSlice":3438753064855436129},"usedName":{"valueName":{"identifier":"extractSetCookieFromSResponse"}},"qualification":null},{"reference":{"otherSlice":7492686854104684507},"usedName":{"typeName":{"identifier":"SRequest"}},"qualification":null},{"reference":{"otherSlice":8642581281670190790},"usedName":{"typeName":{"identifier":"Session"}},"qualification":null},{"reference":{"otherSlice":3675329076143268571},"usedName":{"typeName":{"identifier":"SResponse"}},"qualification":null}],"fragment":["srequest :: SRequest -> Session SResponse","srequest (SRequest req bod)\n  = do app <- ask\n       refChunks <- liftIO $ newIORef $ L.toChunks bod\n       let req'\n             = req{requestBody =\n                     atomicModifyIORef refChunks $\n                       \\ bss ->\n                         case bss of\n                             [] -> ([], S.empty)\n                             x : y -> (y, x)}\n       req'' <- addCookiesToRequest req'\n       response <- liftIO $\n                     do ref <- newIORef $ error \"runResponse gave no result\"\n                        ResponseReceived <- app req'' (runResponse ref)\n                        readIORef ref\n       extractSetCookieFromSResponse response"],"instances":[],"language":{"extensions":["OverloadedStrings","DeriveDataTypeable","MultiParamTypeClasses","NondecreasingIndentation","ExplicitForAll","PatternGuards"],"isInstance":false}}