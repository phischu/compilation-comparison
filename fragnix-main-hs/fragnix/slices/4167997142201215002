{"sliceID":4167997142201215002,"uses":[{"reference":{"builtinModule":"GHC.IORef"},"usedName":{"valueName":{"identifier":"newIORef"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"identifier":"mempty"}},"qualification":null},{"reference":{"builtinModule":"Data.IORef"},"usedName":{"valueName":{"identifier":"atomicModifyIORef"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"operator":"$"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"identifier":"mappend"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"identifier":"return"}},"qualification":null},{"reference":{"builtinModule":"GHC.IORef"},"usedName":{"valueName":{"identifier":"readIORef"}},"qualification":null},{"reference":{"otherSlice":2100366889767087956},"usedName":{"valueName":{"identifier":"toLazyByteString"}},"qualification":null},{"reference":{"otherSlice":6391055533349738388},"usedName":{"valueName":{"identifier":"length"}},"qualification":"L"},{"reference":{"builtinModule":"GHC.Prim"},"usedName":{"valueName":{"identifier":"seq"}},"qualification":null},{"reference":{"builtinModule":"GHC.IORef"},"usedName":{"valueName":{"identifier":"writeIORef"}},"qualification":null},{"reference":{"otherSlice":3675329076143268571},"usedName":{"constructorName":{"identifier":"SResponse"},"constructorTypeName":{"identifier":"SResponse"}},"qualification":null},{"reference":{"otherSlice":3390914165584877492},"usedName":{"constructorName":{"identifier":"ResponseReceived"},"constructorTypeName":{"identifier":"ResponseReceived"}},"qualification":null},{"reference":{"otherSlice":1648177423474526705},"usedName":{"valueName":{"identifier":"responseToStream"}},"qualification":null},{"reference":{"builtinModule":"GHC.IORef"},"usedName":{"typeName":{"identifier":"IORef"}},"qualification":null},{"reference":{"otherSlice":3675329076143268571},"usedName":{"typeName":{"identifier":"SResponse"}},"qualification":null},{"reference":{"otherSlice":8896971230885589368},"usedName":{"typeName":{"identifier":"Response"}},"qualification":null},{"reference":{"builtinModule":"GHC.Types"},"usedName":{"typeName":{"identifier":"IO"}},"qualification":null},{"reference":{"otherSlice":3390914165584877492},"usedName":{"typeName":{"identifier":"ResponseReceived"}},"qualification":null}],"fragment":["runResponse :: IORef SResponse -> Response -> IO ResponseReceived","runResponse ref res\n  = do refBuilder <- newIORef mempty\n       let add y\n             = atomicModifyIORef refBuilder $ \\ x -> (x `mappend` y, ())\n       withBody $ \\ body -> body add (return ())\n       builder <- readIORef refBuilder\n       let lbs = toLazyByteString builder\n           len = L.length lbs\n       seq len $ writeIORef ref $ SResponse s h $ toLazyByteString builder\n       return ResponseReceived\n  where (s, h, withBody) = responseToStream res"],"instances":[],"language":{"extensions":["OverloadedStrings","DeriveDataTypeable","MultiParamTypeClasses","NondecreasingIndentation","ExplicitForAll","PatternGuards"],"isInstance":false}}