{"sliceID":226832892874761179,"uses":[{"reference":{"otherSlice":5090307219451114925},"usedName":{"valueName":{"identifier":"hasBody"}},"qualification":null},{"reference":{"otherSlice":5223747404891055904},"usedName":{"valueName":{"identifier":"sendRsp"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"constructorName":{"identifier":"Nothing"},"constructorTypeName":{"identifier":"Maybe"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"identifier":"return"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"constructorName":{"identifier":"Just"},"constructorTypeName":{"identifier":"Maybe"}},"qualification":null},{"reference":{"otherSlice":4684457803165284207},"usedName":{"valueName":{"identifier":"tickle"}},"qualification":"T"},{"reference":{"otherSlice":8153634949087815593},"usedName":{"constructorName":{"identifier":"RspNoBody"},"constructorTypeName":{"identifier":"Rsp"}},"qualification":null},{"reference":{"otherSlice":135941937043906956},"usedName":{"valueName":{"identifier":"settingsServerName"}},"qualification":null},{"reference":{"otherSlice":135941937043906956},"usedName":{"valueName":{"identifier":"settingsLogger"}},"qualification":null},{"reference":{"otherSlice":9025559142516147699},"usedName":{"valueName":{"identifier":"httpVersion"}},"qualification":null},{"reference":{"otherSlice":9115526196015637650},"usedName":{"valueName":{"identifier":"responseStatus"}},"qualification":null},{"reference":{"otherSlice":3915269491310101546},"usedName":{"valueName":{"identifier":"sanitizeHeaders"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"operator":"$"}},"qualification":null},{"reference":{"otherSlice":6968502614801210961},"usedName":{"valueName":{"identifier":"responseHeaders"}},"qualification":null},{"reference":{"otherSlice":7653252421657792900},"usedName":{"valueName":{"identifier":"indexResponseHeader"}},"qualification":null},{"reference":{"otherSlice":8144835655087874660},"usedName":{"valueName":{"identifier":"threadHandle"}},"qualification":null},{"reference":{"otherSlice":8144835655087874660},"usedName":{"valueName":{"identifier":"getDate"}},"qualification":null},{"reference":{"otherSlice":5302608336726503022},"usedName":{"valueName":{"identifier":"addDate"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"operator":"."}},"qualification":null},{"reference":{"otherSlice":4500086118159713611},"usedName":{"valueName":{"identifier":"addServer"}},"qualification":null},{"reference":{"otherSlice":4966147872518627341},"usedName":{"valueName":{"identifier":"infoFromRequest"}},"qualification":null},{"reference":{"builtinModule":"GHC.Classes"},"usedName":{"valueName":{"identifier":"not"}},"qualification":null},{"reference":{"builtinModule":"GHC.Classes"},"usedName":{"valueName":{"operator":"&&"}},"qualification":null},{"reference":{"otherSlice":4872338928200745908},"usedName":{"valueName":{"identifier":"infoFromResponse"}},"qualification":null},{"reference":{"otherSlice":9025559142516147699},"usedName":{"valueName":{"identifier":"requestMethod"}},"qualification":null},{"reference":{"builtinModule":"GHC.Classes"},"usedName":{"valueName":{"operator":"=="}},"qualification":null},{"reference":{"otherSlice":5113666361284457320},"usedName":{"valueName":{"identifier":"methodHead"}},"qualification":"H"},{"reference":{"otherSlice":8896971230885589368},"usedName":{"constructorName":{"identifier":"ResponseFile"},"constructorTypeName":{"identifier":"Response"}},"qualification":null},{"reference":{"otherSlice":8153634949087815593},"usedName":{"constructorName":{"identifier":"RspFile"},"constructorTypeName":{"identifier":"Rsp"}},"qualification":null},{"reference":{"otherSlice":8896971230885589368},"usedName":{"constructorName":{"identifier":"ResponseBuilder"},"constructorTypeName":{"identifier":"Response"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"identifier":"otherwise"}},"qualification":null},{"reference":{"otherSlice":8153634949087815593},"usedName":{"constructorName":{"identifier":"RspBuilder"},"constructorTypeName":{"identifier":"Rsp"}},"qualification":null},{"reference":{"otherSlice":8896971230885589368},"usedName":{"constructorName":{"identifier":"ResponseStream"},"constructorTypeName":{"identifier":"Response"}},"qualification":null},{"reference":{"otherSlice":8153634949087815593},"usedName":{"constructorName":{"identifier":"RspStream"},"constructorTypeName":{"identifier":"Rsp"}},"qualification":null},{"reference":{"otherSlice":8896971230885589368},"usedName":{"constructorName":{"identifier":"ResponseRaw"},"constructorTypeName":{"identifier":"Response"}},"qualification":null},{"reference":{"otherSlice":8153634949087815593},"usedName":{"constructorName":{"identifier":"RspRaw"},"constructorTypeName":{"identifier":"Rsp"}},"qualification":null},{"reference":{"builtinModule":"GHC.Types"},"usedName":{"constructorName":{"identifier":"False"},"constructorTypeName":{"identifier":"Bool"}},"qualification":null},{"reference":{"otherSlice":135941937043906956},"usedName":{"typeName":{"identifier":"Settings"}},"qualification":null},{"reference":{"otherSlice":3086651893912105973},"usedName":{"typeName":{"identifier":"Connection"}},"qualification":null},{"reference":{"otherSlice":8144835655087874660},"usedName":{"typeName":{"identifier":"InternalInfo"}},"qualification":null},{"reference":{"otherSlice":9025559142516147699},"usedName":{"typeName":{"identifier":"Request"}},"qualification":null},{"reference":{"otherSlice":7895165942623577320},"usedName":{"typeName":{"identifier":"IndexedHeader"}},"qualification":null},{"reference":{"builtinModule":"GHC.Types"},"usedName":{"typeName":{"identifier":"IO"}},"qualification":null},{"reference":{"otherSlice":4010822550476529195},"usedName":{"typeName":{"identifier":"ByteString"}},"qualification":null},{"reference":{"otherSlice":8896971230885589368},"usedName":{"typeName":{"identifier":"Response"}},"qualification":null},{"reference":{"builtinModule":"GHC.Types"},"usedName":{"typeName":{"identifier":"Bool"}},"qualification":null}],"fragment":["sendResponse ::\n             Settings ->\n               Connection ->\n                 InternalInfo ->\n                   Request -> IndexedHeader -> IO ByteString -> Response -> IO Bool","sendResponse settings conn ii req reqidxhdr src response\n  = do hs <- addServerAndDate hs0\n       if hasBody s then\n         do (ms, mlen) <- sendRsp conn ii ver s hs rsp\n            case ms of\n                Nothing -> return ()\n                Just realStatus -> logger req realStatus mlen\n            T.tickle th\n            return ret\n         else\n         do _ <- sendRsp conn ii ver s hs RspNoBody\n            logger req s Nothing\n            T.tickle th\n            return isPersist\n  where defServer = settingsServerName settings\n        logger = settingsLogger settings\n        ver = httpVersion req\n        s = responseStatus response\n        hs0 = sanitizeHeaders $ responseHeaders response\n        rspidxhdr = indexResponseHeader hs0\n        th = threadHandle ii\n        getdate = getDate ii\n        addServerAndDate\n          = addDate getdate rspidxhdr . addServer defServer rspidxhdr\n        (isPersist, isChunked0) = infoFromRequest req reqidxhdr\n        isChunked = not isHead && isChunked0\n        (isKeepAlive, needsChunked)\n          = infoFromResponse rspidxhdr (isPersist, isChunked)\n        isHead = requestMethod req == H.methodHead\n        rsp\n          = case response of\n                ResponseFile _ _ path mPart -> RspFile path mPart reqidxhdr isHead\n                                                 (T.tickle th)\n                ResponseBuilder _ _ b | isHead -> RspNoBody\n                                      | otherwise -> RspBuilder b needsChunked\n                ResponseStream _ _ fb | isHead -> RspNoBody\n                                      | otherwise -> RspStream fb needsChunked th\n                ResponseRaw raw _ -> RspRaw raw src (T.tickle th)\n        !ret\n          = case response of\n                ResponseFile{} -> isPersist\n                ResponseBuilder{} -> isKeepAlive\n                ResponseStream{} -> isKeepAlive\n                ResponseRaw{} -> False"],"instances":[],"language":{"extensions":["OverloadedStrings","ScopedTypeVariables","TupleSections","RankNTypes","BangPatterns","MultiParamTypeClasses","NondecreasingIndentation","ExplicitForAll","PatternGuards"],"isInstance":false}}