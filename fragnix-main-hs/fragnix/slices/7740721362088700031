{"sliceID":7740721362088700031,"uses":[{"reference":{"otherSlice":9025559142516147699},"usedName":{"valueName":{"identifier":"requestHeaderHost"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"operator":">>="}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"constructorName":{"identifier":"Nothing"},"constructorTypeName":{"identifier":"Maybe"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"constructorName":{"identifier":"Just"},"constructorTypeName":{"identifier":"Maybe"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"operator":"$"}},"qualification":null},{"reference":{"otherSlice":1564490560938007565},"usedName":{"valueName":{"identifier":"responseBuilder"}},"qualification":null},{"reference":{"otherSlice":1770321871109794098},"usedName":{"valueName":{"identifier":"hLocation"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"identifier":"mempty"}},"qualification":null},{"reference":{"otherSlice":4394044661351759473},"usedName":{"valueName":{"identifier":"appearsSecure"}},"qualification":null},{"reference":{"builtinModule":"Data.Monoid"},"usedName":{"valueName":{"operator":"<>"}},"qualification":null},{"reference":{"otherSlice":9025559142516147699},"usedName":{"valueName":{"identifier":"rawPathInfo"}},"qualification":null},{"reference":{"otherSlice":9025559142516147699},"usedName":{"valueName":{"identifier":"rawQueryString"}},"qualification":null},{"reference":{"otherSlice":9025559142516147699},"usedName":{"valueName":{"identifier":"requestMethod"}},"qualification":null},{"reference":{"builtinModule":"GHC.Classes"},"usedName":{"valueName":{"operator":"=="}},"qualification":null},{"reference":{"otherSlice":5113666361284457320},"usedName":{"valueName":{"identifier":"methodGet"}},"qualification":null},{"reference":{"otherSlice":7037918368753296545},"usedName":{"valueName":{"identifier":"status301"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"identifier":"otherwise"}},"qualification":null},{"reference":{"otherSlice":4162451654981139810},"usedName":{"valueName":{"identifier":"status307"}},"qualification":null},{"reference":{"otherSlice":4010822550476529195},"usedName":{"typeName":{"identifier":"ByteString"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"typeName":{"identifier":"Maybe"}},"qualification":null},{"reference":{"otherSlice":4688632796141833664},"usedName":{"typeName":{"identifier":"Middleware"}},"qualification":null}],"fragment":["forceDomain :: (ByteString -> Maybe ByteString) -> Middleware","forceDomain checkDomain app req sendResponse\n  = case requestHeaderHost req >>= checkDomain of\n        Nothing -> app req sendResponse\n        Just domain -> sendResponse $ redirectResponse domain\n  where redirectResponse domain\n          = responseBuilder status [(hLocation, location domain)] mempty\n        location h\n          = let p = if appearsSecure req then \"https://\" else \"http://\" in\n              p <> h <> rawPathInfo req <> rawQueryString req\n        status\n          | requestMethod req == methodGet = status301\n          | otherwise = status307"],"instances":[],"language":{"extensions":["OverloadedStrings","MultiParamTypeClasses","NondecreasingIndentation","ExplicitForAll","PatternGuards"],"isInstance":false}}