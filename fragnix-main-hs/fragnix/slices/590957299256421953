{"sliceID":590957299256421953,"uses":[{"reference":{"otherSlice":5290961166819491409},"usedName":{"constructorName":{"identifier":"Scientific"},"constructorTypeName":{"identifier":"Scientific"}},"qualification":null},{"reference":{"builtinModule":"GHC.Classes"},"usedName":{"valueName":{"operator":"=="}},"qualification":null},{"reference":{"builtinModule":"Data.Either"},"usedName":{"constructorName":{"identifier":"Right"},"constructorTypeName":{"identifier":"Either"}},"qualification":null},{"reference":{"builtinModule":"GHC.Classes"},"usedName":{"valueName":{"operator":">"}},"qualification":null},{"reference":{"otherSlice":286957341866390812},"usedName":{"valueName":{"identifier":"limit"}},"qualification":null},{"reference":{"builtinModule":"Data.Either"},"usedName":{"constructorName":{"identifier":"Left"},"constructorTypeName":{"identifier":"Either"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"operator":"$"}},"qualification":null},{"reference":{"builtinModule":"GHC.Real"},"usedName":{"valueName":{"operator":"/"}},"qualification":null},{"reference":{"builtinModule":"GHC.Real"},"usedName":{"valueName":{"identifier":"fromRational"}},"qualification":null},{"reference":{"builtinModule":"GHC.Num"},"usedName":{"valueName":{"operator":"*"}},"qualification":null},{"reference":{"otherSlice":8661004700107269146},"usedName":{"valueName":{"identifier":"magnitude"}},"qualification":null},{"reference":{"builtinModule":"GHC.Real"},"usedName":{"valueName":{"operator":"%"}},"qualification":null},{"reference":{"builtinModule":"GHC.Classes"},"usedName":{"valueName":{"operator":"<"}},"qualification":null},{"reference":{"builtinModule":"GHC.Classes"},"usedName":{"valueName":{"operator":"&&"}},"qualification":null},{"reference":{"builtinModule":"GHC.Num"},"usedName":{"valueName":{"operator":"+"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"identifier":"otherwise"}},"qualification":null},{"reference":{"builtinModule":"GHC.Real"},"usedName":{"valueName":{"identifier":"toRational"}},"qualification":null},{"reference":{"builtinModule":"GHC.Types"},"usedName":{"typeName":{"identifier":"Int"}},"qualification":null},{"reference":{"builtinModule":"GHC.Real"},"usedName":{"valueName":{"identifier":"ceiling"}},"qualification":null},{"reference":{"builtinModule":"GHC.Real"},"usedName":{"valueName":{"identifier":"fromIntegral"}},"qualification":null},{"reference":{"builtinModule":"GHC.Real"},"usedName":{"valueName":{"identifier":"floor"}},"qualification":null},{"reference":{"builtinModule":"GHC.Num"},"usedName":{"valueName":{"operator":"-"}},"qualification":null},{"reference":{"builtinModule":"GHC.Float"},"usedName":{"typeName":{"identifier":"Double"}},"qualification":null},{"reference":{"builtinModule":"GHC.Float"},"usedName":{"valueName":{"identifier":"logBase"}},"qualification":null},{"reference":{"builtinModule":"GHC.Num"},"usedName":{"valueName":{"identifier":"fromInteger"}},"qualification":null},{"reference":{"builtinModule":"GHC.Float"},"usedName":{"valueName":{"identifier":"floatRadix"}},"qualification":null},{"reference":{"builtinModule":"GHC.Err"},"usedName":{"valueName":{"identifier":"undefined"}},"qualification":null},{"reference":{"builtinModule":"GHC.Float"},"usedName":{"valueName":{"identifier":"floatDigits"}},"qualification":null},{"reference":{"builtinModule":"GHC.Float"},"usedName":{"valueName":{"identifier":"floatRange"}},"qualification":null},{"reference":{"otherSlice":2665660221835130053},"usedName":{"valueName":{"identifier":"integerLog10'"}},"qualification":null},{"reference":{"builtinModule":"GHC.Num"},"usedName":{"valueName":{"identifier":"abs"}},"qualification":null},{"reference":{"builtinModule":"GHC.Float"},"usedName":{"typeName":{"identifier":"RealFloat"}},"qualification":null},{"reference":{"otherSlice":5290961166819491409},"usedName":{"typeName":{"identifier":"Scientific"}},"qualification":null},{"reference":{"builtinModule":"Data.Either"},"usedName":{"typeName":{"identifier":"Either"}},"qualification":null}],"fragment":["toBoundedRealFloat ::\n                   forall a . (RealFloat a) => Scientific -> Either a a","toBoundedRealFloat s@(Scientific c e)\n  | c == 0 = Right 0\n  | e > limit =\n    if e > hiLimit then Left $ sign (1 / 0) else\n      Right $ fromRational ((c * magnitude e) % 1)\n  | e < (-limit) =\n    if e < loLimit && e + d < loLimit then Left $ sign 0 else\n      Right $ fromRational (c % magnitude (-e))\n  | otherwise = Right $ fromRational (toRational s)\n  where hiLimit, loLimit :: Int\n        hiLimit = ceiling (fromIntegral hi * log10Radix)\n        loLimit\n          = floor (fromIntegral lo * log10Radix) -\n              ceiling (fromIntegral digits * log10Radix)\n        \n        log10Radix :: Double\n        log10Radix = logBase 10 $ fromInteger radix\n        radix = floatRadix (undefined :: a)\n        digits = floatDigits (undefined :: a)\n        (lo, hi) = floatRange (undefined :: a)\n        d = integerLog10' (abs c)\n        sign x\n          | c < 0 = -x\n          | otherwise = x"],"instances":[],"language":{"extensions":["DeriveDataTypeable","BangPatterns","ScopedTypeVariables","UnboxedTuples","PatternGuards","MultiParamTypeClasses","NondecreasingIndentation","ExplicitForAll"],"isInstance":false}}