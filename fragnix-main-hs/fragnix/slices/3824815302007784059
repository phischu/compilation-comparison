{"sliceID":3824815302007784059,"uses":[{"reference":{"otherSlice":6457520731092503805},"usedName":{"typeName":{"identifier":"Doc"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"typeName":{"identifier":"String"}},"qualification":null},{"reference":{"otherSlice":1321598484882037149},"usedName":{"typeName":{"identifier":"Span"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"operator":"."}},"qualification":null},{"reference":{"otherSlice":8709170533040431805},"usedName":{"valueName":{"identifier":"fullRenderAnn"}},"qualification":null},{"reference":{"otherSlice":820966645442162719},"usedName":{"valueName":{"identifier":"mode"}},"qualification":null},{"reference":{"otherSlice":4124949907505275599},"usedName":{"valueName":{"identifier":"style"}},"qualification":null},{"reference":{"otherSlice":820966645442162719},"usedName":{"valueName":{"identifier":"lineLength"}},"qualification":null},{"reference":{"otherSlice":820966645442162719},"usedName":{"valueName":{"identifier":"ribbonsPerLine"}},"qualification":null},{"reference":{"otherSlice":6839479792748073254},"usedName":{"constructorName":{"identifier":"Spans"},"constructorTypeName":{"identifier":"Spans"}},"qualification":null},{"reference":{"otherSlice":6839479792748073254},"usedName":{"valueName":{"identifier":"sOffset"}},"qualification":null},{"reference":{"otherSlice":6839479792748073254},"usedName":{"valueName":{"identifier":"sStack"}},"qualification":null},{"reference":{"otherSlice":6839479792748073254},"usedName":{"valueName":{"identifier":"sSpans"}},"qualification":null},{"reference":{"otherSlice":6839479792748073254},"usedName":{"valueName":{"identifier":"sOutput"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"identifier":"map"}},"qualification":null},{"reference":{"otherSlice":1321598484882037149},"usedName":{"valueName":{"identifier":"spanStart"}},"qualification":null},{"reference":{"builtinModule":"GHC.Num"},"usedName":{"valueName":{"operator":"-"}},"qualification":null},{"reference":{"otherSlice":1321598484882037149},"usedName":{"constructorName":{"identifier":"Span"},"constructorTypeName":{"identifier":"Span"}},"qualification":null},{"reference":{"otherSlice":1321598484882037149},"usedName":{"valueName":{"identifier":"spanLength"}},"qualification":null},{"reference":{"otherSlice":1321598484882037149},"usedName":{"valueName":{"identifier":"spanAnnotation"}},"qualification":null},{"reference":{"otherSlice":9019407509060218172},"usedName":{"constructorName":{"identifier":"AnnotStart"},"constructorTypeName":{"identifier":"AnnotDetails"}},"qualification":null},{"reference":{"builtinModule":"GHC.Err"},"usedName":{"valueName":{"identifier":"error"}},"qualification":null},{"reference":{"otherSlice":9019407509060218172},"usedName":{"constructorName":{"identifier":"AnnotEnd"},"constructorTypeName":{"identifier":"AnnotDetails"}},"qualification":null},{"reference":{"otherSlice":9019407509060218172},"usedName":{"constructorName":{"identifier":"NoAnnot"},"constructorTypeName":{"identifier":"AnnotDetails"}},"qualification":null},{"reference":{"otherSlice":3167083141647067437},"usedName":{"constructorName":{"identifier":"Chr"},"constructorTypeName":{"identifier":"TextDetails"}},"qualification":null},{"reference":{"builtinModule":"GHC.Num"},"usedName":{"valueName":{"operator":"+"}},"qualification":null},{"reference":{"otherSlice":3167083141647067437},"usedName":{"constructorName":{"identifier":"Str"},"constructorTypeName":{"identifier":"TextDetails"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"operator":"++"}},"qualification":null},{"reference":{"otherSlice":3167083141647067437},"usedName":{"constructorName":{"identifier":"PStr"},"constructorTypeName":{"identifier":"TextDetails"}},"qualification":null}],"fragment":["renderSpans :: Doc ann -> (String, [Span ann])","renderSpans\n  = finalize .\n      fullRenderAnn (mode style) (lineLength style)\n        (ribbonsPerLine style)\n        spanPrinter\n        Spans{sOffset = 0, sStack = [], sSpans = [], sOutput = \"\"}\n  where finalize (Spans size _ spans out) = (out, map adjust spans)\n          where adjust s = s{spanStart = size - spanStart s}\n        mkSpan a end start\n          = Span{spanStart = start, spanLength = start - end,\n                 spanAnnotation = a}\n        spanPrinter AnnotStart s\n          = case sStack s of\n                sp : rest -> s{sSpans = sp (sOffset s) : sSpans s, sStack = rest}\n                _ -> error \"renderSpans: stack underflow\"\n        spanPrinter (AnnotEnd a) s\n          = s{sStack = mkSpan a (sOffset s) : sStack s}\n        spanPrinter (NoAnnot td l) s\n          = case td of\n                Chr c -> s{sOutput = c : sOutput s, sOffset = sOffset s + l}\n                Str t -> s{sOutput = t ++ sOutput s, sOffset = sOffset s + l}\n                PStr t -> s{sOutput = t ++ sOutput s, sOffset = sOffset s + l}"],"instances":[],"language":{"extensions":["BangPatterns","DeriveGeneric","MultiParamTypeClasses","NondecreasingIndentation","ExplicitForAll","PatternGuards"],"isInstance":false}}