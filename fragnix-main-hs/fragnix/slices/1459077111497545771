{"sliceID":1459077111497545771,"uses":[{"reference":{"otherSlice":3858339543871837513},"usedName":{"constructorName":{"identifier":"Acquire"},"constructorTypeName":{"identifier":"Acquire"}},"qualification":null},{"reference":{"builtinModule":"Control.Monad.IO.Class"},"usedName":{"valueName":{"identifier":"liftIO"}},"qualification":null},{"reference":{"otherSlice":3770640103120304714},"usedName":{"valueName":{"identifier":"getMaskingState"}},"qualification":"E"},{"reference":{"otherSlice":6591396614006794967},"usedName":{"valueName":{"identifier":"mask"}},"qualification":"C"},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"operator":"$"}},"qualification":null},{"reference":{"otherSlice":3842035766038090352},"usedName":{"constructorName":{"identifier":"Allocated"},"constructorTypeName":{"identifier":"Allocated"}},"qualification":null},{"reference":{"builtinModule":"GHC.IO"},"usedName":{"constructorName":{"identifier":"Unmasked"},"constructorTypeName":{"identifier":"MaskingState"}},"qualification":"E"},{"reference":{"builtinModule":"GHC.IO"},"usedName":{"valueName":{"identifier":"unsafeUnmask"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"identifier":"id"}},"qualification":null},{"reference":{"otherSlice":1445242623827221268},"usedName":{"valueName":{"identifier":"onException"}},"qualification":"C"},{"reference":{"otherSlice":220949478536803346},"usedName":{"constructorName":{"identifier":"ReleaseException"},"constructorTypeName":{"identifier":"ReleaseType"}},"qualification":null},{"reference":{"otherSlice":220949478536803346},"usedName":{"constructorName":{"identifier":"ReleaseNormal"},"constructorTypeName":{"identifier":"ReleaseType"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"identifier":"return"}},"qualification":null},{"reference":{"otherSlice":6591396614006794967},"usedName":{"typeName":{"identifier":"MonadMask"}},"qualification":"C"},{"reference":{"builtinModule":"Control.Monad.IO.Class"},"usedName":{"typeName":{"identifier":"MonadIO"}},"qualification":null},{"reference":{"otherSlice":3858339543871837513},"usedName":{"typeName":{"identifier":"Acquire"}},"qualification":null}],"fragment":["withEx ::\n         (C.MonadMask m, MonadIO m) => Acquire a -> (a -> m b) -> m b","withEx (Acquire f) g\n  = do origMS <- liftIO E.getMaskingState\n       C.mask $\n         \\ restore ->\n           do Allocated x free <- liftIO $\n                                    f $\n                                      case origMS of\n                                          E.Unmasked -> unsafeUnmask\n                                          _ -> id\n              res <- restore (g x) `C.onException` liftIO (free ReleaseException)\n              liftIO $ free ReleaseNormal\n              return res"],"instances":[],"language":{"extensions":["RankNTypes","MultiParamTypeClasses","DeriveDataTypeable","FlexibleContexts","NondecreasingIndentation","ExplicitForAll","PatternGuards"],"isInstance":false}}