{"sliceID":8648135406647994692,"uses":[{"reference":{"otherSlice":4136673170685477501},"usedName":{"constructorName":{"identifier":"Tip"},"constructorTypeName":{"identifier":"Map"}},"qualification":null},{"reference":{"otherSlice":4136673170685477501},"usedName":{"constructorName":{"identifier":"Bin"},"constructorTypeName":{"identifier":"Map"}},"qualification":null},{"reference":{"builtinModule":"GHC.Classes"},"usedName":{"valueName":{"operator":"<"}},"qualification":null},{"reference":{"otherSlice":3973683569280507261},"usedName":{"valueName":{"identifier":"ratio"}},"qualification":null},{"reference":{"builtinModule":"GHC.Num"},"usedName":{"valueName":{"operator":"*"}},"qualification":null},{"reference":{"builtinModule":"GHC.Num"},"usedName":{"valueName":{"operator":"+"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"identifier":"otherwise"}},"qualification":null},{"reference":{"otherSlice":7731230939223376313},"usedName":{"valueName":{"identifier":"size"}},"qualification":null},{"reference":{"builtinModule":"GHC.Classes"},"usedName":{"valueName":{"operator":">"}},"qualification":null},{"reference":{"otherSlice":3973683569280507261},"usedName":{"valueName":{"identifier":"delta"}},"qualification":null},{"reference":{"builtinModule":"GHC.Err"},"usedName":{"valueName":{"identifier":"error"}},"qualification":null},{"reference":{"otherSlice":4136673170685477501},"usedName":{"typeName":{"identifier":"Map"}},"qualification":null}],"fragment":["balance :: k -> a -> Map k a -> Map k a -> Map k a","balance k x l r\n  = case l of\n        Tip -> case r of\n                   Tip -> Bin 1 k x Tip Tip\n                   (Bin _ _ _ Tip Tip) -> Bin 2 k x Tip r\n                   (Bin _ rk rx Tip rr@(Bin _ _ _ _ _)) -> Bin 3 rk rx\n                                                             (Bin 1 k x Tip Tip)\n                                                             rr\n                   (Bin _ rk rx (Bin _ rlk rlx _ _) Tip) -> Bin 3 rlk rlx\n                                                              (Bin 1 k x Tip Tip)\n                                                              (Bin 1 rk rx Tip Tip)\n                   (Bin rs rk rx rl@(Bin rls rlk rlx rll rlr)\n                      rr@(Bin rrs _ _ _ _)) | rls < ratio * rrs ->\n                                              Bin (1 + rs) rk rx (Bin (1 + rls) k x Tip rl) rr\n                                            | otherwise ->\n                                              Bin (1 + rs) rlk rlx (Bin (1 + size rll) k x Tip rll)\n                                                (Bin (1 + rrs + size rlr) rk rx rlr rr)\n        (Bin ls lk lx ll lr) -> case r of\n                                    Tip -> case (ll, lr) of\n                                               (Tip, Tip) -> Bin 2 k x l Tip\n                                               (Tip, (Bin _ lrk lrx _ _)) -> Bin 3 lrk lrx\n                                                                               (Bin 1 lk lx Tip Tip)\n                                                                               (Bin 1 k x Tip Tip)\n                                               ((Bin _ _ _ _ _), Tip) -> Bin 3 lk lx ll\n                                                                           (Bin 1 k x Tip Tip)\n                                               ((Bin lls _ _ _ _), (Bin lrs lrk lrx lrl lrr)) | lrs\n                                                                                                  <\n                                                                                                  ratio\n                                                                                                    *\n                                                                                                    lls\n                                                                                                ->\n                                                                                                Bin\n                                                                                                  (1 +\n                                                                                                     ls)\n                                                                                                  lk\n                                                                                                  lx\n                                                                                                  ll\n                                                                                                  (Bin\n                                                                                                     (1 +\n                                                                                                        lrs)\n                                                                                                     k\n                                                                                                     x\n                                                                                                     lr\n                                                                                                     Tip)\n                                                                                              | otherwise\n                                                                                                ->\n                                                                                                Bin\n                                                                                                  (1 +\n                                                                                                     ls)\n                                                                                                  lrk\n                                                                                                  lrx\n                                                                                                  (Bin\n                                                                                                     (1 +\n                                                                                                        lls\n                                                                                                        +\n                                                                                                        size\n                                                                                                          lrl)\n                                                                                                     lk\n                                                                                                     lx\n                                                                                                     ll\n                                                                                                     lrl)\n                                                                                                  (Bin\n                                                                                                     (1 +\n                                                                                                        size\n                                                                                                          lrr)\n                                                                                                     k\n                                                                                                     x\n                                                                                                     lrr\n                                                                                                     Tip)\n                                    (Bin rs rk rx rl rr) | rs > delta * ls ->\n                                                           case (rl, rr) of\n                                                               (Bin rls rlk rlx rll rlr,\n                                                                Bin rrs _ _ _ _) | rls < ratio * rrs\n                                                                                   ->\n                                                                                   Bin (1 + ls + rs)\n                                                                                     rk\n                                                                                     rx\n                                                                                     (Bin\n                                                                                        (1 + ls +\n                                                                                           rls)\n                                                                                        k\n                                                                                        x\n                                                                                        l\n                                                                                        rl)\n                                                                                     rr\n                                                                                 | otherwise ->\n                                                                                   Bin (1 + ls + rs)\n                                                                                     rlk\n                                                                                     rlx\n                                                                                     (Bin\n                                                                                        (1 + ls +\n                                                                                           size rll)\n                                                                                        k\n                                                                                        x\n                                                                                        l\n                                                                                        rll)\n                                                                                     (Bin\n                                                                                        (1 + rrs +\n                                                                                           size rlr)\n                                                                                        rk\n                                                                                        rx\n                                                                                        rlr\n                                                                                        rr)\n                                                               (_, _) -> error\n                                                                           \"Failure in Data.Map.balance\"\n                                                         | ls > delta * rs ->\n                                                           case (ll, lr) of\n                                                               (Bin lls _ _ _ _,\n                                                                Bin lrs lrk lrx lrl lrr) | lrs <\n                                                                                             ratio *\n                                                                                               lls\n                                                                                           ->\n                                                                                           Bin\n                                                                                             (1 + ls\n                                                                                                +\n                                                                                                rs)\n                                                                                             lk\n                                                                                             lx\n                                                                                             ll\n                                                                                             (Bin\n                                                                                                (1 +\n                                                                                                   rs\n                                                                                                   +\n                                                                                                   lrs)\n                                                                                                k\n                                                                                                x\n                                                                                                lr\n                                                                                                r)\n                                                                                         | otherwise\n                                                                                           ->\n                                                                                           Bin\n                                                                                             (1 + ls\n                                                                                                +\n                                                                                                rs)\n                                                                                             lrk\n                                                                                             lrx\n                                                                                             (Bin\n                                                                                                (1 +\n                                                                                                   lls\n                                                                                                   +\n                                                                                                   size\n                                                                                                     lrl)\n                                                                                                lk\n                                                                                                lx\n                                                                                                ll\n                                                                                                lrl)\n                                                                                             (Bin\n                                                                                                (1 +\n                                                                                                   rs\n                                                                                                   +\n                                                                                                   size\n                                                                                                     lrr)\n                                                                                                k\n                                                                                                x\n                                                                                                lrr\n                                                                                                r)\n                                                               (_, _) -> error\n                                                                           \"Failure in Data.Map.balance\"\n                                                         | otherwise -> Bin (1 + ls + rs) k x l r"],"instances":[],"language":{"extensions":["DeriveDataTypeable","StandaloneDeriving","RoleAnnotations","TypeFamilies","MultiParamTypeClasses","NondecreasingIndentation","ExplicitForAll","PatternGuards"],"isInstance":false}}