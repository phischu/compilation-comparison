{"sliceID":2310235612847033830,"uses":[{"reference":{"otherSlice":1403166512456590855},"usedName":{"valueName":{"identifier":"viewr"}},"qualification":null},{"reference":{"otherSlice":3678145073151579799},"usedName":{"constructorName":{"identifier":"EmptyR"},"constructorTypeName":{"identifier":"ViewR"}},"qualification":null},{"reference":{"otherSlice":845927994410701206},"usedName":{"valueName":{"identifier":"singleton"}},"qualification":null},{"reference":{"otherSlice":3678145073151579799},"usedName":{"constructorName":{"operator":":>"},"constructorTypeName":{"identifier":"ViewR"}},"qualification":null},{"reference":{"otherSlice":3678145073151579799},"usedName":{"valueName":{"operator":"|>"}},"qualification":null},{"reference":{"otherSlice":2795855979338359899},"usedName":{"valueName":{"identifier":"viewl"}},"qualification":null},{"reference":{"otherSlice":6408052984828414906},"usedName":{"constructorName":{"identifier":"EmptyL"},"constructorTypeName":{"identifier":"ViewL"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"identifier":"return"}},"qualification":null},{"reference":{"otherSlice":6408052984828414906},"usedName":{"constructorName":{"operator":":<"},"constructorTypeName":{"identifier":"ViewL"}},"qualification":null},{"reference":{"builtinModule":"Foreign.Storable"},"usedName":{"valueName":{"identifier":"poke"}},"qualification":null},{"reference":{"builtinModule":"Foreign.C.String"},"usedName":{"valueName":{"identifier":"castCharToCChar"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"operator":">>"}},"qualification":null},{"reference":{"builtinModule":"Foreign.Marshal.Array"},"usedName":{"valueName":{"identifier":"advancePtr"}},"qualification":null},{"reference":{"builtinModule":"Foreign.Marshal.Alloc"},"usedName":{"valueName":{"identifier":"allocaBytes"}},"qualification":null},{"reference":{"otherSlice":6742606937213304270},"usedName":{"valueName":{"identifier":"length"}},"qualification":"S"},{"reference":{"otherSlice":8468946667989408909},"usedName":{"typeName":{"identifier":"Seq"}},"qualification":null},{"reference":{"builtinModule":"GHC.Types"},"usedName":{"typeName":{"identifier":"Char"}},"qualification":null},{"reference":{"builtinModule":"Foreign.C.String"},"usedName":{"typeName":{"identifier":"CString"}},"qualification":null},{"reference":{"builtinModule":"GHC.Types"},"usedName":{"typeName":{"identifier":"IO"}},"qualification":null}],"fragment":["withSeq :: Seq Char -> (CString -> IO a) -> IO a","withSeq s f\n  = let s'\n          = case viewr s of\n                EmptyR -> singleton '\\NUL'\n                _ :> '\\NUL' -> s\n                _ -> s |> '\\NUL'\n        pokes p a\n          = case viewl a of\n                EmptyL -> return ()\n                c :< a' -> poke p (castCharToCChar c) >> pokes (advancePtr p 1) a'\n      in allocaBytes (S.length s') (\\ ptr -> pokes ptr s' >> f ptr)"],"instances":[],"language":{"extensions":["MultiParamTypeClasses","FunctionalDependencies","ForeignFunctionInterface","GeneralizedNewtypeDeriving","FlexibleContexts","TypeSynonymInstances","FlexibleInstances","NondecreasingIndentation","ExplicitForAll","PatternGuards"],"isInstance":false}}