{"sliceID":800719166395393011,"uses":[{"reference":{"builtinModule":"Foreign.Storable"},"usedName":{"typeName":{"identifier":"Storable"}},"qualification":null},{"reference":{"otherSlice":3326759671840124085},"usedName":{"typeName":{"identifier":"PrimMonad"}},"qualification":null},{"reference":{"otherSlice":9042026691638763239},"usedName":{"typeName":{"identifier":"MVector"}},"qualification":null},{"reference":{"otherSlice":3326759671840124085},"usedName":{"typeName":{"identifier":"PrimState"}},"qualification":null},{"reference":{"otherSlice":9042026691638763239},"usedName":{"constructorName":{"identifier":"MVector"},"constructorTypeName":{"identifier":"MVector"}},"qualification":null},{"reference":{"builtinModule":"GHC.Classes"},"usedName":{"valueName":{"operator":"=="}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"identifier":"return"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"identifier":"otherwise"}},"qualification":null},{"reference":{"otherSlice":422491936881079880},"usedName":{"valueName":{"identifier":"unsafePrimToPrim"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"operator":"$"}},"qualification":null},{"reference":{"builtinModule":"Foreign.Storable"},"usedName":{"valueName":{"identifier":"sizeOf"}},"qualification":null},{"reference":{"otherSlice":4274658405209034679},"usedName":{"valueName":{"identifier":"storableSetAsPrim"}},"qualification":null},{"reference":{"builtinModule":"GHC.Err"},"usedName":{"valueName":{"identifier":"undefined"}},"qualification":null},{"reference":{"builtinModule":"GHC.Word"},"usedName":{"typeName":{"identifier":"Word8"}},"qualification":null},{"reference":{"builtinModule":"GHC.Word"},"usedName":{"typeName":{"identifier":"Word16"}},"qualification":null},{"reference":{"builtinModule":"GHC.Word"},"usedName":{"typeName":{"identifier":"Word32"}},"qualification":null},{"reference":{"builtinModule":"GHC.Word"},"usedName":{"typeName":{"identifier":"Word64"}},"qualification":null},{"reference":{"builtinModule":"Foreign.ForeignPtr"},"usedName":{"valueName":{"identifier":"withForeignPtr"}},"qualification":null},{"reference":{"builtinModule":"Foreign.Storable"},"usedName":{"valueName":{"identifier":"poke"}},"qualification":null},{"reference":{"builtinModule":"GHC.Num"},"usedName":{"valueName":{"operator":"*"}},"qualification":null},{"reference":{"builtinModule":"GHC.Classes"},"usedName":{"valueName":{"operator":"<"}},"qualification":null},{"reference":{"builtinModule":"Foreign.Marshal.Array"},"usedName":{"valueName":{"identifier":"copyArray"}},"qualification":null},{"reference":{"builtinModule":"Foreign.Marshal.Array"},"usedName":{"valueName":{"identifier":"advancePtr"}},"qualification":null},{"reference":{"builtinModule":"GHC.Num"},"usedName":{"valueName":{"operator":"-"}},"qualification":null}],"fragment":["storableSet ::\n              (Storable a, PrimMonad m) => MVector (PrimState m) a -> a -> m ()","storableSet (MVector n fp) x\n  | n == 0 = return ()\n  | otherwise =\n    unsafePrimToPrim $\n      case sizeOf x of\n          1 -> storableSetAsPrim n fp x (undefined :: Word8)\n          2 -> storableSetAsPrim n fp x (undefined :: Word16)\n          4 -> storableSetAsPrim n fp x (undefined :: Word32)\n          8 -> storableSetAsPrim n fp x (undefined :: Word64)\n          _ -> withForeignPtr fp $\n                 \\ p ->\n                   do poke p x\n                      let do_set i\n                            | 2 * i < n =\n                              do copyArray (p `advancePtr` i) p i\n                                 do_set (2 * i)\n                            | otherwise = copyArray (p `advancePtr` i) p (n - i)\n                      do_set 1"],"instances":[],"language":{"extensions":["DeriveDataTypeable","FlexibleInstances","MagicHash","MultiParamTypeClasses","ScopedTypeVariables","NondecreasingIndentation","ExplicitForAll","PatternGuards"],"isInstance":false}}