{"sliceID":254558236554609855,"uses":[{"reference":{"builtinModule":"GHC.IO"},"usedName":{"valueName":{"identifier":"mask_"}},"qualification":"E"},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"operator":"$"}},"qualification":null},{"reference":{"builtinModule":"Data.IORef"},"usedName":{"valueName":{"identifier":"atomicModifyIORef"}},"qualification":"I"},{"reference":{"otherSlice":8140350868394868031},"usedName":{"constructorName":{"identifier":"ReleaseMap"},"constructorTypeName":{"identifier":"ReleaseMap"}},"qualification":null},{"reference":{"otherSlice":3035769967170910714},"usedName":{"valueName":{"identifier":"lookup"}},"qualification":"IntMap"},{"reference":{"builtinModule":"Data.Maybe"},"usedName":{"constructorName":{"identifier":"Nothing"},"constructorTypeName":{"identifier":"Maybe"}},"qualification":null},{"reference":{"builtinModule":"Data.Maybe"},"usedName":{"constructorName":{"identifier":"Just"},"constructorTypeName":{"identifier":"Maybe"}},"qualification":null},{"reference":{"otherSlice":256013492086061532},"usedName":{"valueName":{"identifier":"delete"}},"qualification":"IntMap"},{"reference":{"otherSlice":6577957584704791200},"usedName":{"constructorName":{"identifier":"ReleaseEarly"},"constructorTypeName":{"identifier":"ReleaseType"}},"qualification":null},{"reference":{"otherSlice":8140350868394868031},"usedName":{"constructorName":{"identifier":"ReleaseMapClosed"},"constructorTypeName":{"identifier":"ReleaseMap"}},"qualification":null},{"reference":{"builtinModule":"GHC.IORef"},"usedName":{"typeName":{"identifier":"IORef"}},"qualification":"I"},{"reference":{"otherSlice":8140350868394868031},"usedName":{"typeName":{"identifier":"ReleaseMap"}},"qualification":null},{"reference":{"builtinModule":"GHC.Types"},"usedName":{"typeName":{"identifier":"Int"}},"qualification":null},{"reference":{"builtinModule":"Data.Maybe"},"usedName":{"typeName":{"identifier":"Maybe"}},"qualification":null},{"reference":{"builtinModule":"GHC.Types"},"usedName":{"typeName":{"identifier":"IO"}},"qualification":null}],"fragment":["release' ::\n         I.IORef ReleaseMap -> Int -> (Maybe (IO ()) -> IO a) -> IO a","release' istate key act\n  = E.mask_ $\n      do maction <- I.atomicModifyIORef istate lookupAction\n         act maction\n  where lookupAction rm@(ReleaseMap next rf m)\n          = case IntMap.lookup key m of\n                Nothing -> (rm, Nothing)\n                Just action -> (ReleaseMap next rf $ IntMap.delete key m,\n                                Just (action ReleaseEarly))\n        lookupAction ReleaseMapClosed = (ReleaseMapClosed, Nothing)"],"instances":[],"language":{"extensions":["FlexibleContexts","FlexibleInstances","MultiParamTypeClasses","UndecidableInstances","TypeFamilies","RankNTypes","DeriveDataTypeable","ImpredicativeTypes","ConstraintKinds","NondecreasingIndentation","ExplicitForAll","PatternGuards"],"isInstance":false}}