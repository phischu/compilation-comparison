{"sliceID":6341011363919816786,"uses":[{"reference":{"otherSlice":3085819379153306263},"usedName":{"constructorName":{"identifier":"Logger"},"constructorTypeName":{"identifier":"Logger"}},"qualification":null},{"reference":{"otherSlice":6413447273828463008},"usedName":{"constructorName":{"identifier":"LogStr"},"constructorTypeName":{"identifier":"LogStr"}},"qualification":null},{"reference":{"builtinModule":"GHC.Classes"},"usedName":{"valueName":{"operator":">"}},"qualification":null},{"reference":{"otherSlice":6649867546510541993},"usedName":{"valueName":{"identifier":"flushLog"}},"qualification":null},{"reference":{"builtinModule":"Control.Concurrent.MVar"},"usedName":{"valueName":{"identifier":"withMVar"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"operator":"$"}},"qualification":null},{"reference":{"otherSlice":3676411848428504957},"usedName":{"valueName":{"identifier":"toBufIOWith"}},"qualification":null},{"reference":{"otherSlice":3263570309282159097},"usedName":{"valueName":{"identifier":"write"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"identifier":"otherwise"}},"qualification":null},{"reference":{"builtinModule":"Data.IORef"},"usedName":{"valueName":{"identifier":"atomicModifyIORef'"}},"qualification":null},{"reference":{"builtinModule":"Data.Maybe"},"usedName":{"constructorName":{"identifier":"Nothing"},"constructorTypeName":{"identifier":"Maybe"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"identifier":"return"}},"qualification":null},{"reference":{"builtinModule":"Data.Maybe"},"usedName":{"constructorName":{"identifier":"Just"},"constructorTypeName":{"identifier":"Maybe"}},"qualification":null},{"reference":{"otherSlice":6786223773897666507},"usedName":{"valueName":{"identifier":"writeLogStr"}},"qualification":null},{"reference":{"builtinModule":"GHC.Classes"},"usedName":{"valueName":{"operator":"<"}},"qualification":null},{"reference":{"builtinModule":"GHC.Num"},"usedName":{"valueName":{"operator":"+"}},"qualification":null},{"reference":{"builtinModule":"Data.Monoid"},"usedName":{"valueName":{"operator":"<>"}},"qualification":null},{"reference":{"builtinModule":"GHC.IO.FD"},"usedName":{"typeName":{"identifier":"FD"}},"qualification":null},{"reference":{"otherSlice":3085819379153306263},"usedName":{"typeName":{"identifier":"Logger"}},"qualification":null},{"reference":{"otherSlice":6413447273828463008},"usedName":{"typeName":{"identifier":"LogStr"}},"qualification":null},{"reference":{"builtinModule":"GHC.Types"},"usedName":{"typeName":{"identifier":"IO"}},"qualification":null}],"fragment":["pushLog :: FD -> Logger -> LogStr -> IO ()","pushLog fd logger@(Logger mbuf size ref)\n  nlogmsg@(LogStr nlen nbuilder)\n  | nlen > size =\n    do flushLog fd logger\n       withMVar mbuf $ \\ buf -> toBufIOWith buf size (write fd) nbuilder\n  | otherwise =\n    do mmsg <- atomicModifyIORef' ref checkBuf\n       case mmsg of\n           Nothing -> return ()\n           Just msg -> withMVar mbuf $ \\ buf -> writeLogStr fd buf size msg\n  where checkBuf ologmsg@(LogStr olen _)\n          | size < olen + nlen = (nlogmsg, Just ologmsg)\n          | otherwise = (ologmsg <> nlogmsg, Nothing)"],"instances":[],"language":{"extensions":["BangPatterns","MultiParamTypeClasses","NondecreasingIndentation","ExplicitForAll","PatternGuards"],"isInstance":false}}