{"sliceID":7537203681569752970,"uses":[{"reference":{"otherSlice":260850562356698968},"usedName":{"valueName":{"identifier":"viewr"}},"qualification":null},{"reference":{"otherSlice":5507254915546375839},"usedName":{"constructorName":{"identifier":"EmptyR"},"constructorTypeName":{"identifier":"ViewR"}},"qualification":null},{"reference":{"otherSlice":8427715792648227450},"usedName":{"valueName":{"identifier":"singleton"}},"qualification":null},{"reference":{"otherSlice":5507254915546375839},"usedName":{"constructorName":{"operator":":>"},"constructorTypeName":{"identifier":"ViewR"}},"qualification":null},{"reference":{"otherSlice":5507254915546375839},"usedName":{"valueName":{"operator":"|>"}},"qualification":null},{"reference":{"otherSlice":354684057922072400},"usedName":{"valueName":{"identifier":"viewl"}},"qualification":null},{"reference":{"otherSlice":7270423061335848636},"usedName":{"constructorName":{"identifier":"EmptyL"},"constructorTypeName":{"identifier":"ViewL"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"identifier":"return"}},"qualification":null},{"reference":{"otherSlice":7270423061335848636},"usedName":{"constructorName":{"operator":":<"},"constructorTypeName":{"identifier":"ViewL"}},"qualification":null},{"reference":{"builtinModule":"Foreign.Storable"},"usedName":{"valueName":{"identifier":"poke"}},"qualification":null},{"reference":{"builtinModule":"Foreign.C.String"},"usedName":{"valueName":{"identifier":"castCharToCChar"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"operator":">>"}},"qualification":null},{"reference":{"builtinModule":"Foreign.Marshal.Array"},"usedName":{"valueName":{"identifier":"advancePtr"}},"qualification":null},{"reference":{"builtinModule":"Foreign.Marshal.Alloc"},"usedName":{"valueName":{"identifier":"allocaBytes"}},"qualification":null},{"reference":{"otherSlice":7787832157326777448},"usedName":{"valueName":{"identifier":"length"}},"qualification":"S"},{"reference":{"otherSlice":9208044541903137161},"usedName":{"typeName":{"identifier":"Seq"}},"qualification":null},{"reference":{"builtinModule":"GHC.Types"},"usedName":{"typeName":{"identifier":"Char"}},"qualification":null},{"reference":{"builtinModule":"Foreign.C.String"},"usedName":{"typeName":{"identifier":"CString"}},"qualification":null},{"reference":{"builtinModule":"GHC.Types"},"usedName":{"typeName":{"identifier":"IO"}},"qualification":null}],"fragment":["withSeq :: Seq Char -> (CString -> IO a) -> IO a","withSeq s f\n  = let s'\n          = case viewr s of\n                EmptyR -> singleton '\\NUL'\n                _ :> '\\NUL' -> s\n                _ -> s |> '\\NUL'\n        pokes p a\n          = case viewl a of\n                EmptyL -> return ()\n                c :< a' -> poke p (castCharToCChar c) >> pokes (advancePtr p 1) a'\n      in allocaBytes (S.length s') (\\ ptr -> pokes ptr s' >> f ptr)"],"instances":[],"language":{"extensions":["MultiParamTypeClasses","FunctionalDependencies","ForeignFunctionInterface","GeneralizedNewtypeDeriving","FlexibleContexts","TypeSynonymInstances","FlexibleInstances","NondecreasingIndentation","ExplicitForAll","PatternGuards"],"isInstance":false}}