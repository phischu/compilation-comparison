{"sliceID":7640805558543418222,"uses":[{"reference":{"otherSlice":9025559142516147699},"usedName":{"valueName":{"identifier":"requestHeaderHost"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"identifier":"return"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"operator":"$"}},"qualification":null},{"reference":{"otherSlice":1564490560938007565},"usedName":{"valueName":{"identifier":"responseBuilder"}},"qualification":null},{"reference":{"otherSlice":1770321871109794098},"usedName":{"valueName":{"identifier":"hLocation"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"identifier":"mempty"}},"qualification":null},{"reference":{"builtinModule":"Data.Monoid"},"usedName":{"valueName":{"operator":"<>"}},"qualification":null},{"reference":{"otherSlice":9025559142516147699},"usedName":{"valueName":{"identifier":"rawPathInfo"}},"qualification":null},{"reference":{"otherSlice":9025559142516147699},"usedName":{"valueName":{"identifier":"rawQueryString"}},"qualification":null},{"reference":{"otherSlice":9025559142516147699},"usedName":{"valueName":{"identifier":"requestMethod"}},"qualification":null},{"reference":{"builtinModule":"GHC.Classes"},"usedName":{"valueName":{"operator":"=="}},"qualification":null},{"reference":{"otherSlice":5113666361284457320},"usedName":{"valueName":{"identifier":"methodGet"}},"qualification":null},{"reference":{"otherSlice":7037918368753296545},"usedName":{"valueName":{"identifier":"status301"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"identifier":"otherwise"}},"qualification":null},{"reference":{"otherSlice":4162451654981139810},"usedName":{"valueName":{"identifier":"status307"}},"qualification":null},{"reference":{"otherSlice":9025559142516147699},"usedName":{"typeName":{"identifier":"Request"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"typeName":{"identifier":"Maybe"}},"qualification":null},{"reference":{"otherSlice":8896971230885589368},"usedName":{"typeName":{"identifier":"Response"}},"qualification":null}],"fragment":["redirectResponse :: Request -> Maybe Response","redirectResponse req\n  = do host <- requestHeaderHost req\n       return $ responseBuilder status [(hLocation, location host)] mempty\n  where location h\n          = \"https://\" <> h <> rawPathInfo req <> rawQueryString req\n        status\n          | requestMethod req == methodGet = status301\n          | otherwise = status307"],"instances":[],"language":{"extensions":["OverloadedStrings","MultiParamTypeClasses","NondecreasingIndentation","ExplicitForAll","PatternGuards"],"isInstance":false}}