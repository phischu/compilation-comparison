{"sliceID":6816602203490591168,"uses":[{"reference":{"otherSlice":6245327673196656924},"usedName":{"constructorName":{"identifier":"TBQueue"},"constructorTypeName":{"identifier":"TBQueue"}},"qualification":null},{"reference":{"builtinModule":"GHC.Conc.Sync"},"usedName":{"valueName":{"identifier":"readTVar"}},"qualification":null},{"reference":{"builtinModule":"GHC.Conc.Sync"},"usedName":{"valueName":{"identifier":"writeTVar"}},"qualification":null},{"reference":{"builtinModule":"GHC.Num"},"usedName":{"valueName":{"operator":"+"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"identifier":"return"}},"qualification":null},{"reference":{"builtinModule":"GHC.Conc.Sync"},"usedName":{"valueName":{"identifier":"retry"}},"qualification":null},{"reference":{"builtinModule":"GHC.List"},"usedName":{"valueName":{"identifier":"reverse"}},"qualification":null},{"reference":{"otherSlice":6245327673196656924},"usedName":{"typeName":{"identifier":"TBQueue"}},"qualification":null},{"reference":{"builtinModule":"GHC.Conc.Sync"},"usedName":{"typeName":{"identifier":"STM"}},"qualification":null}],"fragment":["readTBQueue :: TBQueue a -> STM a","readTBQueue (TBQueue rsize read _wsize write)\n  = do xs <- readTVar read\n       r <- readTVar rsize\n       writeTVar rsize (r + 1)\n       case xs of\n           (x : xs') -> do writeTVar read xs'\n                           return x\n           [] -> do ys <- readTVar write\n                    case ys of\n                        [] -> retry\n                        _ -> do let (z : zs) = reverse ys\n                                writeTVar write []\n                                writeTVar read zs\n                                return z"],"instances":[],"language":{"extensions":["DeriveDataTypeable","MultiParamTypeClasses","NondecreasingIndentation","ExplicitForAll","PatternGuards"],"isInstance":false}}