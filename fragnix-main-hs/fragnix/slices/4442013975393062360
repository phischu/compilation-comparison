{"sliceID":4442013975393062360,"uses":[{"reference":{"otherSlice":5413756915200985750},"usedName":{"constructorName":{"identifier":"TBQueue"},"constructorTypeName":{"identifier":"TBQueue"}},"qualification":null},{"reference":{"builtinModule":"GHC.Conc.Sync"},"usedName":{"valueName":{"identifier":"readTVar"}},"qualification":null},{"reference":{"builtinModule":"GHC.Classes"},"usedName":{"valueName":{"operator":"/="}},"qualification":null},{"reference":{"builtinModule":"GHC.Conc.Sync"},"usedName":{"valueName":{"identifier":"writeTVar"}},"qualification":null},{"reference":{"builtinModule":"GHC.Num"},"usedName":{"valueName":{"operator":"-"}},"qualification":null},{"reference":{"builtinModule":"GHC.Conc.Sync"},"usedName":{"valueName":{"identifier":"retry"}},"qualification":null},{"reference":{"otherSlice":5413756915200985750},"usedName":{"typeName":{"identifier":"TBQueue"}},"qualification":null},{"reference":{"builtinModule":"GHC.Conc.Sync"},"usedName":{"typeName":{"identifier":"STM"}},"qualification":null}],"fragment":["writeTBQueue :: TBQueue a -> a -> STM ()","writeTBQueue (TBQueue rsize _read wsize write) a\n  = do w <- readTVar wsize\n       if (w /= 0) then do writeTVar wsize (w - 1) else\n         do r <- readTVar rsize\n            if (r /= 0) then\n              do writeTVar rsize 0\n                 writeTVar wsize (r - 1)\n              else retry\n       listend <- readTVar write\n       writeTVar write (a : listend)"],"instances":[],"language":{"extensions":["DeriveDataTypeable","MultiParamTypeClasses","NondecreasingIndentation","ExplicitForAll","PatternGuards"],"isInstance":false}}