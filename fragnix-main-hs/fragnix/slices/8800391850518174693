{"sliceID":8800391850518174693,"uses":[{"reference":{"otherSlice":7315165113918992770},"usedName":{"typeName":{"identifier":"Format"}},"qualification":null},{"reference":{"otherSlice":1394949281745390129},"usedName":{"typeName":{"identifier":"Stream"}},"qualification":null},{"reference":{"otherSlice":4053808545383669285},"usedName":{"valueName":{"identifier":"unsafeLiftIO"}},"qualification":null},{"reference":{"builtinModule":"Foreign.C.String"},"usedName":{"valueName":{"identifier":"peekCAString"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"operator":"=<<"}},"qualification":null},{"reference":{"otherSlice":9132833030706532575},"usedName":{"valueName":{"identifier":"c_zlibVersion"}},"qualification":null},{"reference":{"builtinModule":"GHC.Classes"},"usedName":{"valueName":{"operator":"=="}},"qualification":null},{"reference":{"otherSlice":7315165113918992770},"usedName":{"constructorName":{"identifier":"GZip"},"constructorTypeName":{"identifier":"Format"}},"qualification":null},{"reference":{"builtinModule":"GHC.Classes"},"usedName":{"valueName":{"operator":"||"}},"qualification":null},{"reference":{"otherSlice":7315165113918992770},"usedName":{"constructorName":{"identifier":"GZipOrZlib"},"constructorTypeName":{"identifier":"Format"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"identifier":"fail"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"operator":"$"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"operator":"++"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"identifier":"return"}},"qualification":null}],"fragment":["checkFormatSupported :: Format -> Stream ()","checkFormatSupported format\n  = do version <- unsafeLiftIO (peekCAString =<< c_zlibVersion)\n       case version of\n           ('1' : ('.' : ('1' : ('.' : _)))) | format == GZip ||\n                                                 format == GZipOrZlib\n                                               ->\n                                               fail $\n                                                 \"version 1.1.x of the zlib C library does not support the\"\n                                                   ++\n                                                   \" 'gzip' format via the in-memory api, only the 'raw' and \"\n                                                     ++ \" 'zlib' formats.\"\n           _ -> return ()"],"instances":[],"language":{"extensions":["ForeignFunctionInterface","DeriveDataTypeable","DeriveGeneric","MultiParamTypeClasses","NondecreasingIndentation","ExplicitForAll","PatternGuards"],"isInstance":false}}