{"sliceID":3438753064855436129,"uses":[{"reference":{"builtinModule":"GHC.List"},"usedName":{"valueName":{"identifier":"filter"}},"qualification":null},{"reference":{"builtinModule":"GHC.Classes"},"usedName":{"valueName":{"operator":"=="}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"operator":"."}},"qualification":null},{"reference":{"builtinModule":"Data.Tuple"},"usedName":{"valueName":{"identifier":"fst"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"operator":"$"}},"qualification":null},{"reference":{"otherSlice":3675329076143268571},"usedName":{"valueName":{"identifier":"simpleHeaders"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"identifier":"map"}},"qualification":null},{"reference":{"otherSlice":5538075945191479269},"usedName":{"valueName":{"identifier":"parseSetCookie"}},"qualification":"Cookie"},{"reference":{"builtinModule":"Data.Tuple"},"usedName":{"valueName":{"identifier":"snd"}},"qualification":null},{"reference":{"otherSlice":7069053758073321185},"usedName":{"valueName":{"identifier":"modifyClientCookies"}},"qualification":null},{"reference":{"otherSlice":13655969299986864},"usedName":{"valueName":{"identifier":"union"}},"qualification":"Map"},{"reference":{"otherSlice":6276720371911720776},"usedName":{"valueName":{"identifier":"fromList"}},"qualification":"Map"},{"reference":{"otherSlice":3208799123422311968},"usedName":{"valueName":{"identifier":"setCookieName"}},"qualification":"Cookie"},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"identifier":"return"}},"qualification":null},{"reference":{"otherSlice":3675329076143268571},"usedName":{"typeName":{"identifier":"SResponse"}},"qualification":null},{"reference":{"otherSlice":8642581281670190790},"usedName":{"typeName":{"identifier":"Session"}},"qualification":null}],"fragment":["extractSetCookieFromSResponse :: SResponse -> Session SResponse","extractSetCookieFromSResponse response\n  = do let setCookieHeaders\n             = filter ((\"Set-Cookie\" ==) . fst) $ simpleHeaders response\n       let newClientCookies\n             = map (Cookie.parseSetCookie . snd) setCookieHeaders\n       modifyClientCookies\n         (Map.union\n            (Map.fromList\n               [(Cookie.setCookieName c, c) | c <- newClientCookies]))\n       return response"],"instances":[],"language":{"extensions":["OverloadedStrings","DeriveDataTypeable","MultiParamTypeClasses","NondecreasingIndentation","ExplicitForAll","PatternGuards"],"isInstance":false}}