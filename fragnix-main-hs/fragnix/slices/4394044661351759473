{"sliceID":4394044661351759473,"uses":[{"reference":{"otherSlice":9025559142516147699},"usedName":{"valueName":{"identifier":"isSecure"}},"qualification":null},{"reference":{"builtinModule":"GHC.Classes"},"usedName":{"valueName":{"operator":"||"}},"qualification":null},{"reference":{"builtinModule":"Data.Foldable"},"usedName":{"valueName":{"identifier":"any"}},"qualification":null},{"reference":{"builtinModule":"Data.Tuple"},"usedName":{"valueName":{"identifier":"uncurry"}},"qualification":null},{"reference":{"builtinModule":"GHC.Classes"},"usedName":{"valueName":{"operator":"=="}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"operator":"."}},"qualification":null},{"reference":{"builtinModule":"GHC.List"},"usedName":{"valueName":{"identifier":"take"}},"qualification":null},{"reference":{"otherSlice":136854382516080737},"usedName":{"valueName":{"identifier":"split"}},"qualification":"C"},{"reference":{"otherSlice":2314137045087607773},"usedName":{"typeName":{"identifier":"HeaderName"}},"qualification":null},{"reference":{"otherSlice":4010822550476529195},"usedName":{"typeName":{"identifier":"ByteString"}},"qualification":null},{"reference":{"builtinModule":"GHC.Types"},"usedName":{"typeName":{"identifier":"Bool"}},"qualification":null},{"reference":{"builtinModule":"Data.Maybe"},"usedName":{"valueName":{"identifier":"maybe"}},"qualification":null},{"reference":{"builtinModule":"GHC.Types"},"usedName":{"constructorName":{"identifier":"False"},"constructorTypeName":{"identifier":"Bool"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"operator":"$"}},"qualification":null},{"reference":{"builtinModule":"GHC.List"},"usedName":{"valueName":{"identifier":"lookup"}},"qualification":null},{"reference":{"otherSlice":9025559142516147699},"usedName":{"valueName":{"identifier":"requestHeaders"}},"qualification":null},{"reference":{"otherSlice":9025559142516147699},"usedName":{"typeName":{"identifier":"Request"}},"qualification":null}],"fragment":["appearsSecure :: Request -> Bool","appearsSecure request\n  = isSecure request ||\n      any (uncurry matchHeader)\n        [(\"HTTPS\", (== \"on\")), (\"HTTP_X_FORWARDED_SSL\", (== \"on\")),\n         (\"HTTP_X_FORWARDED_SCHEME\", (== \"https\")),\n         (\"HTTP_X_FORWARDED_PROTO\",\n          ((== [\"https\"]) . take 1 . C.split ',')),\n         (\"X-Forwarded-Proto\", (== \"https\"))]\n  where matchHeader :: HeaderName -> (ByteString -> Bool) -> Bool\n        matchHeader h f = maybe False f $ lookup h $ requestHeaders request"],"instances":[],"language":{"extensions":["OverloadedStrings","DeriveDataTypeable","MultiParamTypeClasses","NondecreasingIndentation","ExplicitForAll","PatternGuards"],"isInstance":false}}