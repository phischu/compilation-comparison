{"sliceID":958675940120742873,"uses":[{"reference":{"builtinModule":"GHC.Arr"},"usedName":{"typeName":{"identifier":"Ix"}},"qualification":null},{"reference":{"builtinModule":"GHC.Types"},"usedName":{"typeName":{"identifier":"Int"}},"qualification":null},{"reference":{"builtinModule":"GHC.ST"},"usedName":{"valueName":{"identifier":"runST"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"operator":">>="}},"qualification":null},{"reference":{"otherSlice":346399340270742757},"usedName":{"valueName":{"identifier":"unsafeAccumArrayST"}},"qualification":null},{"reference":{"otherSlice":456988961920531281},"usedName":{"valueName":{"identifier":"newArray_"}},"qualification":null},{"reference":{"otherSlice":3688379431863502467},"usedName":{"valueName":{"identifier":"safeRangeSize"}},"qualification":null},{"reference":{"builtinModule":"Control.Monad"},"usedName":{"valueName":{"identifier":"sequence_"}},"qualification":null},{"reference":{"otherSlice":456988961920531281},"usedName":{"valueName":{"identifier":"unsafeWrite"}},"qualification":null},{"reference":{"builtinModule":"GHC.Num"},"usedName":{"valueName":{"operator":"-"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"identifier":"return"}},"qualification":null},{"reference":{"otherSlice":456988961920531281},"usedName":{"typeName":{"identifier":"MArray"}},"qualification":null},{"reference":{"otherSlice":456988961920531281},"usedName":{"valueName":{"identifier":"unsafeRead"}},"qualification":null},{"reference":{"builtinModule":"GHC.ST"},"usedName":{"typeName":{"identifier":"ST"}},"qualification":null},{"reference":{"builtinModule":"GHC.Arr"},"usedName":{"typeName":{"identifier":"STArray"}},"qualification":null},{"reference":{"otherSlice":456988961920531281},"usedName":{"valueName":{"identifier":"getBounds"}},"qualification":null},{"reference":{"otherSlice":456988961920531281},"usedName":{"valueName":{"identifier":"getNumElements"}},"qualification":null},{"reference":{"builtinModule":"Control.Monad"},"usedName":{"valueName":{"identifier":"mapM"}},"qualification":null},{"reference":{"builtinModule":"GHC.List"},"usedName":{"valueName":{"identifier":"zip"}},"qualification":null}],"fragment":["thaw :: (Ix i, IArray a e, MArray b e m) => a i e -> m (b i e)","thaw arr\n  = case bounds arr of\n        (l, u) -> do marr <- newArray_ (l, u)\n                     let n = safeRangeSize (l, u)\n                     sequence_ [unsafeWrite marr i (unsafeAt arr i) | i <- [0 .. n - 1]]\n                     return marr","unsafeAccumST ::\n                (IArray a e, Ix i) =>\n                (e -> e' -> e) -> a i e -> [(Int, e')] -> ST s (STArray s i e)","unsafeAccumST f arr ies\n  = do marr <- thaw arr\n       sequence_\n         [do old <- unsafeRead marr i\n             unsafeWrite marr i (f old new)\n          | (i, new) <- ies]\n       return marr","unsafeReplaceST ::\n                  (IArray a e, Ix i) => a i e -> [(Int, e)] -> ST s (STArray s i e)","unsafeReplaceST arr ies\n  = do marr <- thaw arr\n       sequence_ [unsafeWrite marr i e | (i, e) <- ies]\n       return marr","unsafeFreeze ::\n               (Ix i, MArray a e m, IArray b e) => a i e -> m (b i e)","unsafeFreeze = freeze","freeze :: (Ix i, MArray a e m, IArray b e) => a i e -> m (b i e)","freeze marr\n  = do (l, u) <- getBounds marr\n       n <- getNumElements marr\n       es <- mapM (unsafeRead marr) [0 .. n - 1]\n       return (listArray (l, u) es)","listArray :: (IArray a e, Ix i) => (i, i) -> [e] -> a i e","listArray (l, u) es\n  = let n = safeRangeSize (l, u) in\n      unsafeArray (l, u) (zip [0 .. n - 1] es)","class IArray a e where\n        bounds :: Ix i => a i e -> (i, i)\n        \n        numElements :: Ix i => a i e -> Int\n        \n        unsafeArray :: Ix i => (i, i) -> [(Int, e)] -> a i e\n        \n        unsafeAt :: Ix i => a i e -> Int -> e\n        \n        unsafeReplace :: Ix i => a i e -> [(Int, e)] -> a i e\n        \n        unsafeAccum ::\n                      Ix i => (e -> e' -> e) -> a i e -> [(Int, e')] -> a i e\n        \n        unsafeAccumArray ::\n                           Ix i => (e -> e' -> e) -> e -> (i, i) -> [(Int, e')] -> a i e\n        unsafeReplace arr ies\n          = runST (unsafeReplaceST arr ies >>= unsafeFreeze)\n        unsafeAccum f arr ies\n          = runST (unsafeAccumST f arr ies >>= unsafeFreeze)\n        unsafeAccumArray f e lu ies\n          = runST (unsafeAccumArrayST f e lu ies >>= unsafeFreeze)"],"instances":[{"instanceID":7580896937042423494,"instancePart":"OfClassForBuiltinType"},{"instanceID":1905470688174945734,"instancePart":"OfClass"},{"instanceID":5563491145779858868,"instancePart":"OfClass"},{"instanceID":3422855029194273858,"instancePart":"OfClass"},{"instanceID":4111159601727205723,"instancePart":"OfClass"},{"instanceID":8511898285917921891,"instancePart":"OfClass"},{"instanceID":3935625338467982234,"instancePart":"OfClass"},{"instanceID":437488509470023671,"instancePart":"OfClass"},{"instanceID":3201348453551084086,"instancePart":"OfClass"},{"instanceID":1779404981529468515,"instancePart":"OfClass"},{"instanceID":6327191992049161616,"instancePart":"OfClass"},{"instanceID":7705885001076135379,"instancePart":"OfClass"},{"instanceID":2563499071625901657,"instancePart":"OfClass"},{"instanceID":1680469627390805538,"instancePart":"OfClass"},{"instanceID":259574385204843121,"instancePart":"OfClass"},{"instanceID":8490848339159281572,"instancePart":"OfClass"},{"instanceID":8659220419494706250,"instancePart":"OfClass"},{"instanceID":8803107751376715691,"instancePart":"OfClass"}],"language":{"extensions":["BangPatterns","RankNTypes","MagicHash","UnboxedTuples","MultiParamTypeClasses","FlexibleInstances","FlexibleContexts","DeriveDataTypeable","UnliftedFFITypes","NondecreasingIndentation","ExplicitForAll","PatternGuards"],"isInstance":false}}