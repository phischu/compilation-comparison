{"sliceID":4841639120353963505,"uses":[{"reference":{"otherSlice":6639586890906344950},"usedName":{"constructorName":{"identifier":"RequestLoggerSettings"},"constructorTypeName":{"identifier":"RequestLoggerSettings"}},"qualification":null},{"reference":{"otherSlice":6639586890906344950},"usedName":{"valueName":{"identifier":"autoFlush"}},"qualification":null},{"reference":{"otherSlice":6639586890906344950},"usedName":{"valueName":{"identifier":"destination"}},"qualification":null},{"reference":{"otherSlice":6639586890906344950},"usedName":{"valueName":{"identifier":"outputFormat"}},"qualification":null},{"reference":{"otherSlice":1559428315390301593},"usedName":{"constructorName":{"identifier":"Handle"},"constructorTypeName":{"identifier":"Destination"}},"qualification":null},{"reference":{"otherSlice":1128272352767327333},"usedName":{"valueName":{"identifier":"hPutStr"}},"qualification":"BS"},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"operator":"."}},"qualification":null},{"reference":{"otherSlice":7592588302058761502},"usedName":{"valueName":{"identifier":"logToByteString"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"identifier":"when"}},"qualification":null},{"reference":{"builtinModule":"GHC.IO.Handle"},"usedName":{"valueName":{"identifier":"hFlush"}},"qualification":null},{"reference":{"otherSlice":1559428315390301593},"usedName":{"constructorName":{"identifier":"Logger"},"constructorTypeName":{"identifier":"Destination"}},"qualification":null},{"reference":{"otherSlice":1263561754642865115},"usedName":{"valueName":{"identifier":"pushLogStr"}},"qualification":null},{"reference":{"otherSlice":3777923793096267540},"usedName":{"valueName":{"identifier":"flushLogStr"}},"qualification":null},{"reference":{"otherSlice":1559428315390301593},"usedName":{"constructorName":{"identifier":"Callback"},"constructorTypeName":{"identifier":"Destination"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"identifier":"return"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"operator":">>"}},"qualification":null},{"reference":{"otherSlice":6962402794287518712},"usedName":{"constructorName":{"identifier":"Apache"},"constructorTypeName":{"identifier":"OutputFormat"}},"qualification":null},{"reference":{"otherSlice":3602187968320465177},"usedName":{"valueName":{"identifier":"getDateGetter"}},"qualification":null},{"reference":{"otherSlice":6517936429686700920},"usedName":{"valueName":{"identifier":"initLogger"}},"qualification":null},{"reference":{"otherSlice":243636928150449734},"usedName":{"constructorName":{"identifier":"LogCallback"},"constructorTypeName":{"identifier":"LogType"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"operator":"$"}},"qualification":null},{"reference":{"otherSlice":1172311900967161017},"usedName":{"valueName":{"identifier":"apacheMiddleware"}},"qualification":null},{"reference":{"otherSlice":6962402794287518712},"usedName":{"constructorName":{"identifier":"Detailed"},"constructorTypeName":{"identifier":"OutputFormat"}},"qualification":null},{"reference":{"otherSlice":218902354821810936},"usedName":{"valueName":{"identifier":"detailedMiddleware"}},"qualification":null},{"reference":{"otherSlice":6962402794287518712},"usedName":{"constructorName":{"identifier":"CustomOutputFormat"},"constructorTypeName":{"identifier":"OutputFormat"}},"qualification":null},{"reference":{"otherSlice":8954608968831290944},"usedName":{"valueName":{"identifier":"customMiddleware"}},"qualification":null},{"reference":{"otherSlice":6962402794287518712},"usedName":{"constructorName":{"identifier":"CustomOutputFormatWithDetails"},"constructorTypeName":{"identifier":"OutputFormat"}},"qualification":null},{"reference":{"otherSlice":3009833177225164003},"usedName":{"valueName":{"identifier":"customMiddlewareWithDetails"}},"qualification":null},{"reference":{"otherSlice":6639586890906344950},"usedName":{"typeName":{"identifier":"RequestLoggerSettings"}},"qualification":null},{"reference":{"builtinModule":"GHC.Types"},"usedName":{"typeName":{"identifier":"IO"}},"qualification":null},{"reference":{"otherSlice":4688632796141833664},"usedName":{"typeName":{"identifier":"Middleware"}},"qualification":null}],"fragment":["mkRequestLogger :: RequestLoggerSettings -> IO Middleware","mkRequestLogger RequestLoggerSettings{..}\n  = do let (callback, flusher)\n             = case destination of\n                   Handle h -> (BS.hPutStr h . logToByteString,\n                                when autoFlush (hFlush h))\n                   Logger l -> (pushLogStr l, when autoFlush (flushLogStr l))\n                   Callback c -> (c, return ())\n           callbackAndFlush str = callback str >> flusher\n       case outputFormat of\n           Apache ipsrc -> do getdate <- getDateGetter flusher\n                              apache <- initLogger ipsrc (LogCallback callback flusher) getdate\n                              return $ apacheMiddleware apache\n           Detailed useColors -> detailedMiddleware callbackAndFlush useColors\n           CustomOutputFormat formatter -> do getDate <- getDateGetter flusher\n                                              return $\n                                                customMiddleware callbackAndFlush getDate formatter\n           CustomOutputFormatWithDetails\n             formatter -> do getdate <- getDateGetter flusher\n                             return $\n                               customMiddlewareWithDetails callbackAndFlush getdate formatter"],"instances":[],"language":{"extensions":["OverloadedStrings","RecordWildCards","MultiParamTypeClasses","NondecreasingIndentation","ExplicitForAll","PatternGuards"],"isInstance":false}}