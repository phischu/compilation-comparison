{"sliceID":8902357943113421301,"uses":[{"reference":{"otherSlice":6428440366533706494},"usedName":{"valueName":{"identifier":"readInteger"}},"qualification":"B"},{"reference":{"builtinModule":"GHC.Classes"},"usedName":{"valueName":{"operator":"<"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"constructorName":{"identifier":"Just"},"constructorTypeName":{"identifier":"Maybe"}},"qualification":null},{"reference":{"otherSlice":4161432964376494898},"usedName":{"constructorName":{"identifier":"ByteRangeSuffix"},"constructorTypeName":{"identifier":"ByteRange"}},"qualification":"H"},{"reference":{"builtinModule":"GHC.Num"},"usedName":{"valueName":{"identifier":"negate"}},"qualification":null},{"reference":{"builtinModule":"GHC.Classes"},"usedName":{"valueName":{"operator":">="}},"qualification":null},{"reference":{"otherSlice":4161432964376494898},"usedName":{"constructorName":{"identifier":"ByteRangeFromTo"},"constructorTypeName":{"identifier":"ByteRange"}},"qualification":"H"},{"reference":{"otherSlice":4161432964376494898},"usedName":{"constructorName":{"identifier":"ByteRangeFrom"},"constructorTypeName":{"identifier":"ByteRange"}},"qualification":"H"},{"reference":{"otherSlice":7202692338078551997},"usedName":{"valueName":{"identifier":"null"}},"qualification":"B"},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"identifier":"otherwise"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"operator":"."}},"qualification":null},{"reference":{"otherSlice":6327919249248331934},"usedName":{"valueName":{"identifier":"isPrefixOf"}},"qualification":"B"},{"reference":{"otherSlice":3748312495235440417},"usedName":{"valueName":{"identifier":"drop"}},"qualification":"B"},{"reference":{"otherSlice":7235567377809295464},"usedName":{"valueName":{"identifier":"length"}},"qualification":"B"},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"constructorName":{"identifier":"Nothing"},"constructorTypeName":{"identifier":"Maybe"}},"qualification":null},{"reference":{"otherSlice":4010822550476529195},"usedName":{"typeName":{"identifier":"ByteString"}},"qualification":"B"},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"typeName":{"identifier":"Maybe"}},"qualification":null},{"reference":{"otherSlice":3977564787684066621},"usedName":{"typeName":{"identifier":"ByteRanges"}},"qualification":"H"}],"fragment":["parseByteRanges :: B.ByteString -> Maybe H.ByteRanges","parseByteRanges bs1\n  = do bs2 <- stripPrefix \"bytes=\" bs1\n       (r, bs3) <- range bs2\n       ranges (r :) bs3\n  where range bs2\n          = do (i, bs3) <- B.readInteger bs2\n               if i < 0 then Just (H.ByteRangeSuffix (negate i), bs3) else\n                 do bs4 <- stripPrefix \"-\" bs3\n                    case B.readInteger bs4 of\n                        Just (j, bs5) | j >= i -> Just (H.ByteRangeFromTo i j, bs5)\n                        _ -> Just (H.ByteRangeFrom i, bs4)\n        ranges front bs3\n          | B.null bs3 = Just (front [])\n          | otherwise =\n            do bs4 <- stripPrefix \",\" bs3\n               (r, bs5) <- range bs4\n               ranges (front . (r :)) bs5\n        stripPrefix x y\n          | x `B.isPrefixOf` y = Just (B.drop (B.length x) y)\n          | otherwise = Nothing"],"instances":[],"language":{"extensions":["OverloadedStrings","BangPatterns","MultiParamTypeClasses","NondecreasingIndentation","ExplicitForAll","PatternGuards"],"isInstance":false}}