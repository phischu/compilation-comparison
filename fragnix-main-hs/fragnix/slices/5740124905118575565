{"sliceID":5740124905118575565,"uses":[{"reference":{"otherSlice":2635124505070119885},"usedName":{"constructorName":{"identifier":"Literal"},"constructorTypeName":{"identifier":"RoutePattern"}},"qualification":null},{"reference":{"builtinModule":"GHC.Classes"},"usedName":{"valueName":{"operator":"=="}},"qualification":null},{"reference":{"otherSlice":3514858690846020691},"usedName":{"valueName":{"identifier":"path"}},"qualification":null},{"reference":{"builtinModule":"Data.Maybe"},"usedName":{"constructorName":{"identifier":"Just"},"constructorTypeName":{"identifier":"Maybe"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"identifier":"otherwise"}},"qualification":null},{"reference":{"builtinModule":"Data.Maybe"},"usedName":{"constructorName":{"identifier":"Nothing"},"constructorTypeName":{"identifier":"Maybe"}},"qualification":null},{"reference":{"otherSlice":2635124505070119885},"usedName":{"constructorName":{"identifier":"Function"},"constructorTypeName":{"identifier":"RoutePattern"}},"qualification":null},{"reference":{"otherSlice":2635124505070119885},"usedName":{"constructorName":{"identifier":"Capture"},"constructorTypeName":{"identifier":"RoutePattern"}},"qualification":null},{"reference":{"otherSlice":1575410303872274317},"usedName":{"valueName":{"identifier":"split"}},"qualification":"T"},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"operator":"$"}},"qualification":null},{"reference":{"otherSlice":4161256625989359579},"usedName":{"valueName":{"identifier":"null"}},"qualification":"T"},{"reference":{"builtinModule":"Data.Monoid"},"usedName":{"valueName":{"identifier":"mconcat"}},"qualification":null},{"reference":{"otherSlice":7244785346505740380},"usedName":{"valueName":{"identifier":"head"}},"qualification":"T"},{"reference":{"otherSlice":116995044031816886},"usedName":{"valueName":{"identifier":"tail"}},"qualification":"T"},{"reference":{"otherSlice":2635124505070119885},"usedName":{"typeName":{"identifier":"RoutePattern"}},"qualification":null},{"reference":{"otherSlice":30758760526534613},"usedName":{"typeName":{"identifier":"Request"}},"qualification":null},{"reference":{"builtinModule":"Data.Maybe"},"usedName":{"typeName":{"identifier":"Maybe"}},"qualification":null},{"reference":{"otherSlice":8945367361678195461},"usedName":{"typeName":{"identifier":"Param"}},"qualification":null}],"fragment":["matchRoute :: RoutePattern -> Request -> Maybe [Param]","matchRoute (Literal pat) req\n  | pat == path req = Just []\n  | otherwise = Nothing\nmatchRoute (Function fun) req = fun req\nmatchRoute (Capture pat) req\n  = go (T.split (== '/') pat) (T.split (== '/') $ path req) []\n  where go [] [] prs = Just prs\n        go [] r prs\n          | T.null (mconcat r) = Just prs\n          | otherwise = Nothing\n        go p [] prs\n          | T.null (mconcat p) = Just prs\n          | otherwise = Nothing\n        go (p : ps) (r : rs) prs\n          | p == r = go ps rs prs\n          | T.null p = Nothing\n          | T.head p == ':' = go ps rs $ (T.tail p, r) : prs\n          | otherwise = Nothing"],"instances":[],"language":{"extensions":["FlexibleContexts","FlexibleInstances","OverloadedStrings","RankNTypes","ScopedTypeVariables","MultiParamTypeClasses","NondecreasingIndentation","ExplicitForAll","PatternGuards"],"isInstance":false}}