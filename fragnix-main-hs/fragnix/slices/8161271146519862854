{"sliceID":8161271146519862854,"uses":[{"reference":{"otherSlice":4140461930772351125},"usedName":{"valueName":{"identifier":"withType"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"operator":"$"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"identifier":"fmap"}},"qualification":null},{"reference":{"otherSlice":2200509164339420844},"usedName":{"valueName":{"identifier":"applyCon"}},"qualification":null},{"reference":{"otherSlice":847687915866770813},"usedName":{"valueName":{"identifier":"toJSON"}},"qualification":null},{"reference":{"otherSlice":4647881203417095295},"usedName":{"valueName":{"identifier":"consToJSON"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"identifier":"map"}},"qualification":null},{"reference":{"otherSlice":250412078360184208},"usedName":{"valueName":{"identifier":"tvbName"}},"qualification":null},{"reference":{"builtinModule":"Data.List"},"usedName":{"valueName":{"identifier":"foldl'"}},"qualification":null},{"reference":{"otherSlice":5961014460351920517},"usedName":{"typeName":{"identifier":"Options"}},"qualification":null}],"fragment":["deriveToJSON :: Options -> Name -> Q [Dec]","deriveToJSON opts name\n  = withType name $ \\ tvbs cons -> fmap (: []) $ fromCons tvbs cons\n  where fromCons :: [TyVarBndr] -> [Con] -> Q Dec\n        fromCons tvbs cons\n          = instanceD (applyCon ''ToJSON typeNames)\n              (classType `appT` instanceType)\n              [funD 'toJSON [clause [] (normalB $ consToJSON opts cons) []]]\n          where classType = conT ''ToJSON\n                typeNames = map tvbName tvbs\n                instanceType = foldl' appT (conT name) $ map varT typeNames"],"instances":[],"language":{"extensions":["FlexibleInstances","IncoherentInstances","NamedFieldPuns","NoImplicitPrelude","OverlappingInstances","TemplateHaskell","UndecidableInstances","MultiParamTypeClasses","NondecreasingIndentation","ExplicitForAll","PatternGuards"],"isInstance":false}}