{"sliceID":4928580478462344078,"uses":[{"reference":{"otherSlice":3318792464992779933},"usedName":{"valueName":{"identifier":"runSTArray"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"operator":"$"}},"qualification":null},{"reference":{"otherSlice":5632142578980093812},"usedName":{"valueName":{"identifier":"newArray"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"constructorName":{"identifier":"Nothing"},"constructorTypeName":{"identifier":"Maybe"}},"qualification":null},{"reference":{"builtinModule":"Data.Foldable"},"usedName":{"valueName":{"identifier":"mapM_"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"identifier":"return"}},"qualification":null},{"reference":{"builtinModule":"GHC.Classes"},"usedName":{"valueName":{"operator":"=="}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"identifier":"otherwise"}},"qualification":null},{"reference":{"otherSlice":8093274895463719824},"usedName":{"valueName":{"identifier":"writeArray"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"constructorName":{"identifier":"Just"},"constructorTypeName":{"identifier":"Maybe"}},"qualification":null},{"reference":{"otherSlice":2043161144754187370},"usedName":{"typeName":{"identifier":"Header"}},"qualification":null},{"reference":{"builtinModule":"GHC.Types"},"usedName":{"typeName":{"identifier":"Int"}},"qualification":null},{"reference":{"otherSlice":2314137045087607773},"usedName":{"typeName":{"identifier":"HeaderName"}},"qualification":null},{"reference":{"otherSlice":7895165942623577320},"usedName":{"typeName":{"identifier":"IndexedHeader"}},"qualification":null}],"fragment":["traverseHeader ::\n               [Header] -> Int -> (HeaderName -> Int) -> IndexedHeader","traverseHeader hdr maxidx getIndex\n  = runSTArray $\n      do arr <- newArray (0, maxidx) Nothing\n         mapM_ (insert arr) hdr\n         return arr\n  where insert arr (key, val)\n          | idx == (-1) = return ()\n          | otherwise = writeArray arr idx (Just val)\n          where idx = getIndex key"],"instances":[],"language":{"extensions":["OverloadedStrings","FlexibleContexts","MultiParamTypeClasses","NondecreasingIndentation","ExplicitForAll","PatternGuards"],"isInstance":false}}