{"sliceID":1723864833354466887,"uses":[{"reference":{"otherSlice":4664153159892864006},"usedName":{"valueName":{"identifier":"hasBody"}},"qualification":null},{"reference":{"otherSlice":9126667572877535482},"usedName":{"valueName":{"identifier":"sendRsp"}},"qualification":null},{"reference":{"otherSlice":1398065711734772341},"usedName":{"valueName":{"identifier":"tickle"}},"qualification":"T"},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"identifier":"return"}},"qualification":null},{"reference":{"otherSlice":2300307687018205899},"usedName":{"valueName":{"identifier":"sendResponseNoBody"}},"qualification":null},{"reference":{"otherSlice":30758760526534613},"usedName":{"valueName":{"identifier":"httpVersion"}},"qualification":null},{"reference":{"otherSlice":1162006070208960329},"usedName":{"valueName":{"identifier":"responseStatus"}},"qualification":null},{"reference":{"otherSlice":2561030100759734952},"usedName":{"valueName":{"identifier":"responseHeaders"}},"qualification":null},{"reference":{"otherSlice":2272644745176068125},"usedName":{"valueName":{"identifier":"indexResponseHeader"}},"qualification":null},{"reference":{"otherSlice":3323754789693346301},"usedName":{"valueName":{"identifier":"threadHandle"}},"qualification":null},{"reference":{"otherSlice":3323754789693346301},"usedName":{"valueName":{"identifier":"dateCacher"}},"qualification":null},{"reference":{"otherSlice":1939179726282255886},"usedName":{"valueName":{"identifier":"addDate"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"operator":"."}},"qualification":null},{"reference":{"otherSlice":1274019143014132588},"usedName":{"valueName":{"identifier":"addServer"}},"qualification":null},{"reference":{"builtinModule":"GHC.Arr"},"usedName":{"valueName":{"operator":"!"}},"qualification":null},{"reference":{"otherSlice":6253936816604868018},"usedName":{"valueName":{"identifier":"idxRange"}},"qualification":null},{"reference":{"otherSlice":1206602344576082919},"usedName":{"valueName":{"identifier":"infoFromRequest"}},"qualification":null},{"reference":{"otherSlice":2044444274120205325},"usedName":{"valueName":{"identifier":"infoFromResponse"}},"qualification":null},{"reference":{"otherSlice":4388261176215324957},"usedName":{"constructorName":{"identifier":"ResponseFile"},"constructorTypeName":{"identifier":"Response"}},"qualification":null},{"reference":{"otherSlice":5677364752125141640},"usedName":{"constructorName":{"identifier":"RspFile"},"constructorTypeName":{"identifier":"Rsp"}},"qualification":null},{"reference":{"otherSlice":4388261176215324957},"usedName":{"constructorName":{"identifier":"ResponseBuilder"},"constructorTypeName":{"identifier":"Response"}},"qualification":null},{"reference":{"otherSlice":5677364752125141640},"usedName":{"constructorName":{"identifier":"RspBuilder"},"constructorTypeName":{"identifier":"Rsp"}},"qualification":null},{"reference":{"otherSlice":4388261176215324957},"usedName":{"constructorName":{"identifier":"ResponseStream"},"constructorTypeName":{"identifier":"Response"}},"qualification":null},{"reference":{"otherSlice":5677364752125141640},"usedName":{"constructorName":{"identifier":"RspStream"},"constructorTypeName":{"identifier":"Rsp"}},"qualification":null},{"reference":{"otherSlice":4388261176215324957},"usedName":{"constructorName":{"identifier":"ResponseRaw"},"constructorTypeName":{"identifier":"Response"}},"qualification":null},{"reference":{"otherSlice":5677364752125141640},"usedName":{"constructorName":{"identifier":"RspRaw"},"constructorTypeName":{"identifier":"Rsp"}},"qualification":null},{"reference":{"builtinModule":"GHC.Types"},"usedName":{"constructorName":{"identifier":"False"},"constructorTypeName":{"identifier":"Bool"}},"qualification":null},{"reference":{"otherSlice":8642306666063513779},"usedName":{"typeName":{"identifier":"ByteString"}},"qualification":null},{"reference":{"otherSlice":4881703223122348873},"usedName":{"typeName":{"identifier":"Connection"}},"qualification":null},{"reference":{"otherSlice":3323754789693346301},"usedName":{"typeName":{"identifier":"InternalInfo"}},"qualification":null},{"reference":{"otherSlice":30758760526534613},"usedName":{"typeName":{"identifier":"Request"}},"qualification":null},{"reference":{"otherSlice":8986303668099301941},"usedName":{"typeName":{"identifier":"IndexedHeader"}},"qualification":null},{"reference":{"builtinModule":"GHC.Types"},"usedName":{"typeName":{"identifier":"IO"}},"qualification":null},{"reference":{"otherSlice":4388261176215324957},"usedName":{"typeName":{"identifier":"Response"}},"qualification":null},{"reference":{"builtinModule":"GHC.Types"},"usedName":{"typeName":{"identifier":"Bool"}},"qualification":null}],"fragment":["sendResponse ::\n             ByteString ->\n               Connection ->\n                 InternalInfo ->\n                   Request -> IndexedHeader -> IO ByteString -> Response -> IO Bool","sendResponse defServer conn ii req reqidxhdr src response\n  = do hs <- addServerAndDate hs0\n       if hasBody s req then\n         do sendRsp conn ver s hs rsp\n            T.tickle th\n            return ret\n         else\n         do sendResponseNoBody conn ver s hs\n            T.tickle th\n            return isPersist\n  where ver = httpVersion req\n        s = responseStatus response\n        hs0 = responseHeaders response\n        rspidxhdr = indexResponseHeader hs0\n        th = threadHandle ii\n        dc = dateCacher ii\n        addServerAndDate\n          = addDate dc rspidxhdr . addServer defServer rspidxhdr\n        mRange = reqidxhdr ! idxRange\n        reqinfo@(isPersist, _) = infoFromRequest req reqidxhdr\n        (isKeepAlive, needsChunked) = infoFromResponse rspidxhdr reqinfo\n        rsp\n          = case response of\n                ResponseFile _ _ path mPart -> RspFile path mPart mRange\n                                                 (T.tickle th)\n                ResponseBuilder _ _ b -> RspBuilder b needsChunked\n                ResponseStream _ _ fb -> RspStream fb needsChunked th\n                ResponseRaw raw _ -> RspRaw raw src (T.tickle th)\n        ret\n          = case response of\n                ResponseFile{} -> isPersist\n                ResponseBuilder{} -> isKeepAlive\n                ResponseStream{} -> isKeepAlive\n                ResponseRaw{} -> False"],"instances":[],"language":{"extensions":["OverloadedStrings","ScopedTypeVariables","TupleSections","RankNTypes","MultiParamTypeClasses","NondecreasingIndentation","ExplicitForAll","PatternGuards"],"isInstance":false}}