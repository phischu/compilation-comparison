{"sliceID":900372457403457732,"uses":[{"reference":{"otherSlice":7380852613632988749},"usedName":{"valueName":{"identifier":"getProtocolNumber"}},"qualification":null},{"reference":{"otherSlice":4360120424655547227},"usedName":{"valueName":{"identifier":"defaultHints"}},"qualification":null},{"reference":{"otherSlice":327701426414781642},"usedName":{"valueName":{"identifier":"addrFlags"}},"qualification":null},{"reference":{"otherSlice":5386083940265316368},"usedName":{"constructorName":{"identifier":"AI_ADDRCONFIG"},"constructorTypeName":{"identifier":"AddrInfoFlag"}},"qualification":null},{"reference":{"otherSlice":327701426414781642},"usedName":{"valueName":{"identifier":"addrProtocol"}},"qualification":null},{"reference":{"otherSlice":327701426414781642},"usedName":{"valueName":{"identifier":"addrSocketType"}},"qualification":null},{"reference":{"otherSlice":5966676263279217999},"usedName":{"constructorName":{"identifier":"Stream"},"constructorTypeName":{"identifier":"SocketType"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"identifier":"map"}},"qualification":null},{"reference":{"otherSlice":327701426414781642},"usedName":{"valueName":{"identifier":"addrAddress"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"identifier":"liftM"}},"qualification":null},{"reference":{"otherSlice":2990950460556442721},"usedName":{"valueName":{"identifier":"getAddrInfo"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"constructorName":{"identifier":"Just"},"constructorTypeName":{"identifier":"Maybe"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"constructorName":{"identifier":"Nothing"},"constructorTypeName":{"identifier":"Maybe"}},"qualification":null},{"reference":{"otherSlice":2786269774230682128},"usedName":{"valueName":{"identifier":"listenOn"}},"qualification":null},{"reference":{"otherSlice":4010172434535953718},"usedName":{"valueName":{"identifier":"accept"}},"qualification":"Socket"},{"reference":{"builtinModule":"GHC.Classes"},"usedName":{"valueName":{"identifier":"not"}},"qualification":null},{"reference":{"otherSlice":4112987266023136759},"usedName":{"valueName":{"identifier":"sClose"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"operator":">>"}},"qualification":null},{"reference":{"otherSlice":2210167494878030646},"usedName":{"valueName":{"identifier":"socketToHandle"}},"qualification":null},{"reference":{"builtinModule":"GHC.IO.IOMode"},"usedName":{"constructorName":{"identifier":"ReadMode"},"constructorTypeName":{"identifier":"IOMode"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"operator":">>="}},"qualification":null},{"reference":{"builtinModule":"GHC.IO.Handle.Text"},"usedName":{"valueName":{"identifier":"hGetContents"}},"qualification":null},{"reference":{"otherSlice":3812070640366845611},"usedName":{"constructorName":{"identifier":"SockAddrInet"},"constructorTypeName":{"identifier":"SockAddr"}},"qualification":null},{"reference":{"builtinModule":"GHC.Classes"},"usedName":{"valueName":{"operator":"=="}},"qualification":null},{"reference":{"builtinModule":"GHC.Types"},"usedName":{"constructorName":{"identifier":"True"},"constructorTypeName":{"identifier":"Bool"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"identifier":"otherwise"}},"qualification":null},{"reference":{"otherSlice":3812070640366845611},"usedName":{"constructorName":{"identifier":"SockAddrInet6"},"constructorTypeName":{"identifier":"SockAddr"}},"qualification":null},{"reference":{"builtinModule":"GHC.Types"},"usedName":{"constructorName":{"identifier":"False"},"constructorTypeName":{"identifier":"Bool"}},"qualification":null},{"reference":{"otherSlice":2265647500502576818},"usedName":{"typeName":{"identifier":"HostName"}},"qualification":null},{"reference":{"otherSlice":3607940413037742872},"usedName":{"typeName":{"identifier":"PortID"}},"qualification":null},{"reference":{"builtinModule":"GHC.Types"},"usedName":{"typeName":{"identifier":"IO"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"typeName":{"identifier":"String"}},"qualification":null}],"fragment":["recvFrom :: HostName -> PortID -> IO String","recvFrom host port\n  = do proto <- getProtocolNumber \"tcp\"\n       let hints\n             = defaultHints{addrFlags = [AI_ADDRCONFIG], addrProtocol = proto,\n                            addrSocketType = Stream}\n       allowed <- map addrAddress `liftM`\n                    getAddrInfo (Just hints) (Just host) Nothing\n       s <- listenOn port\n       let waiting\n             = do (s', addr) <- Socket.accept s\n                  if not (addr `oneOf` allowed) then sClose s' >> waiting else\n                    socketToHandle s' ReadMode >>= hGetContents\n       waiting\n  where a@(SockAddrInet _ ha) `oneOf` ((SockAddrInet _ hb) : bs)\n          | ha == hb = True\n          | otherwise = a `oneOf` bs\n        a@(SockAddrInet6 _ _ ha _) `oneOf` ((SockAddrInet6 _ _ hb _) : bs)\n          | ha == hb = True\n          | otherwise = a `oneOf` bs\n        _ `oneOf` _ = False"],"instances":[],"language":{"extensions":["DeriveDataTypeable","ForeignFunctionInterface","TypeSynonymInstances","MultiParamTypeClasses","NondecreasingIndentation","ExplicitForAll","PatternGuards"],"isInstance":false}}