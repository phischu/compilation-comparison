{"sliceID":2975194074296699226,"uses":[{"reference":{"otherSlice":980706217060864070},"usedName":{"constructorName":{"identifier":"ReaperSettings"},"constructorTypeName":{"identifier":"ReaperSettings"}},"qualification":null},{"reference":{"otherSlice":980706217060864070},"usedName":{"valueName":{"identifier":"reaperAction"}},"qualification":null},{"reference":{"otherSlice":980706217060864070},"usedName":{"valueName":{"identifier":"reaperCons"}},"qualification":null},{"reference":{"otherSlice":980706217060864070},"usedName":{"valueName":{"identifier":"reaperDelay"}},"qualification":null},{"reference":{"otherSlice":980706217060864070},"usedName":{"valueName":{"identifier":"reaperEmpty"}},"qualification":null},{"reference":{"otherSlice":980706217060864070},"usedName":{"valueName":{"identifier":"reaperNull"}},"qualification":null},{"reference":{"builtinModule":"GHC.IORef"},"usedName":{"valueName":{"identifier":"newIORef"}},"qualification":null},{"reference":{"otherSlice":6389988487962542786},"usedName":{"constructorName":{"identifier":"NoReaper"},"constructorTypeName":{"identifier":"State"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"identifier":"return"}},"qualification":null},{"reference":{"otherSlice":8936823632848668199},"usedName":{"constructorName":{"identifier":"Reaper"},"constructorTypeName":{"identifier":"Reaper"}},"qualification":null},{"reference":{"otherSlice":8936823632848668199},"usedName":{"valueName":{"identifier":"reaperAdd"}},"qualification":null},{"reference":{"otherSlice":5587083517758966160},"usedName":{"valueName":{"identifier":"update"}},"qualification":null},{"reference":{"otherSlice":8936823632848668199},"usedName":{"valueName":{"identifier":"reaperRead"}},"qualification":null},{"reference":{"otherSlice":8936823632848668199},"usedName":{"valueName":{"identifier":"reaperStop"}},"qualification":null},{"reference":{"builtinModule":"GHC.IORef"},"usedName":{"valueName":{"identifier":"readIORef"}},"qualification":null},{"reference":{"otherSlice":6389988487962542786},"usedName":{"constructorName":{"identifier":"Workload"},"constructorTypeName":{"identifier":"State"}},"qualification":null},{"reference":{"builtinModule":"Data.IORef"},"usedName":{"valueName":{"identifier":"atomicModifyIORef'"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"operator":"$"}},"qualification":null},{"reference":{"otherSlice":980706217060864070},"usedName":{"typeName":{"identifier":"ReaperSettings"}},"qualification":null},{"reference":{"builtinModule":"GHC.Types"},"usedName":{"typeName":{"identifier":"IO"}},"qualification":null},{"reference":{"otherSlice":8936823632848668199},"usedName":{"typeName":{"identifier":"Reaper"}},"qualification":null}],"fragment":["mkReaper ::\n         ReaperSettings workload item -> IO (Reaper workload item)","mkReaper settings@ReaperSettings{..}\n  = do stateRef <- newIORef NoReaper\n       return\n         Reaper{reaperAdd = update settings stateRef,\n                reaperRead = readRef stateRef, reaperStop = stop stateRef}\n  where readRef stateRef\n          = do mx <- readIORef stateRef\n               case mx of\n                   NoReaper -> return reaperEmpty\n                   Workload wl -> return wl\n        stop stateRef\n          = atomicModifyIORef' stateRef $\n              \\ mx ->\n                case mx of\n                    NoReaper -> (NoReaper, reaperEmpty)\n                    Workload x -> (Workload reaperEmpty, x)"],"instances":[],"language":{"extensions":["RecordWildCards","MultiParamTypeClasses","NondecreasingIndentation","ExplicitForAll","PatternGuards"],"isInstance":false}}