{"sliceID":4156642968506792875,"uses":[{"reference":{"otherSlice":91774999909123259},"usedName":{"typeName":{"identifier":"Buffer"}},"qualification":null},{"reference":{"otherSlice":2439198389408872677},"usedName":{"typeName":{"identifier":"BufSize"}},"qualification":null},{"reference":{"otherSlice":5413756915200985750},"usedName":{"typeName":{"identifier":"TBQueue"}},"qualification":null},{"reference":{"otherSlice":1936115390264180453},"usedName":{"typeName":{"identifier":"Sequence"}},"qualification":null},{"reference":{"builtinModule":"GHC.Types"},"usedName":{"typeName":{"identifier":"IO"}},"qualification":null},{"reference":{"otherSlice":9117606929373792949},"usedName":{"typeName":{"identifier":"Leftover"}},"qualification":null},{"reference":{"builtinModule":"GHC.Types"},"usedName":{"typeName":{"identifier":"Bool"}},"qualification":null},{"reference":{"otherSlice":8422411450248709681},"usedName":{"typeName":{"identifier":"BytesFilled"}},"qualification":null},{"reference":{"builtinModule":"GHC.Conc.Sync"},"usedName":{"valueName":{"identifier":"atomically"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"operator":"$"}},"qualification":null},{"reference":{"otherSlice":1618774930596596319},"usedName":{"valueName":{"identifier":"tryReadTBQueue"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"constructorName":{"identifier":"Nothing"},"constructorTypeName":{"identifier":"Maybe"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"identifier":"return"}},"qualification":null},{"reference":{"otherSlice":9117606929373792949},"usedName":{"constructorName":{"identifier":"LZero"},"constructorTypeName":{"identifier":"Leftover"}},"qualification":null},{"reference":{"builtinModule":"GHC.Types"},"usedName":{"constructorName":{"identifier":"True"},"constructorTypeName":{"identifier":"Bool"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"constructorName":{"identifier":"Just"},"constructorTypeName":{"identifier":"Maybe"}},"qualification":null},{"reference":{"otherSlice":1936115390264180453},"usedName":{"constructorName":{"identifier":"SBuilder"},"constructorTypeName":{"identifier":"Sequence"}},"qualification":null},{"reference":{"otherSlice":10585601343515720},"usedName":{"valueName":{"identifier":"runBuilder"}},"qualification":"B"},{"reference":{"builtinModule":"GHC.Num"},"usedName":{"valueName":{"operator":"+"}},"qualification":null},{"reference":{"otherSlice":6247261920417293319},"usedName":{"constructorName":{"identifier":"Done"},"constructorTypeName":{"identifier":"Next"}},"qualification":"B"},{"reference":{"builtinModule":"GHC.Ptr"},"usedName":{"valueName":{"identifier":"plusPtr"}},"qualification":null},{"reference":{"builtinModule":"GHC.Num"},"usedName":{"valueName":{"operator":"-"}},"qualification":null},{"reference":{"otherSlice":6247261920417293319},"usedName":{"constructorName":{"identifier":"More"},"constructorTypeName":{"identifier":"Next"}},"qualification":"B"},{"reference":{"otherSlice":9117606929373792949},"usedName":{"constructorName":{"identifier":"LOne"},"constructorTypeName":{"identifier":"Leftover"}},"qualification":null},{"reference":{"otherSlice":6247261920417293319},"usedName":{"constructorName":{"identifier":"Chunk"},"constructorTypeName":{"identifier":"Next"}},"qualification":"B"},{"reference":{"otherSlice":9117606929373792949},"usedName":{"constructorName":{"identifier":"LTwo"},"constructorTypeName":{"identifier":"Leftover"}},"qualification":null},{"reference":{"otherSlice":1936115390264180453},"usedName":{"constructorName":{"identifier":"SFlush"},"constructorTypeName":{"identifier":"Sequence"}},"qualification":null},{"reference":{"otherSlice":1936115390264180453},"usedName":{"constructorName":{"identifier":"SFinish"},"constructorTypeName":{"identifier":"Sequence"}},"qualification":null},{"reference":{"builtinModule":"GHC.Types"},"usedName":{"constructorName":{"identifier":"False"},"constructorTypeName":{"identifier":"Bool"}},"qualification":null}],"fragment":["runStreamBuilder ::\n                 Buffer ->\n                   BufSize -> TBQueue Sequence -> IO (Leftover, Bool, BytesFilled)","runStreamBuilder buf0 room0 sq = loop buf0 room0 0\n  where loop !buf !room !total\n          = do mbuilder <- atomically $ tryReadTBQueue sq\n               case mbuilder of\n                   Nothing -> return (LZero, True, total)\n                   Just (SBuilder builder) -> do (len, signal) <- B.runBuilder builder\n                                                                    buf\n                                                                    room\n                                                 let !total' = total + len\n                                                 case signal of\n                                                     B.Done -> loop (buf `plusPtr` len) (room - len)\n                                                                 total'\n                                                     B.More _ writer -> return\n                                                                          (LOne writer, True,\n                                                                           total')\n                                                     B.Chunk bs writer -> return\n                                                                            (LTwo bs writer, True,\n                                                                             total')\n                   Just SFlush -> return (LZero, True, total)\n                   Just SFinish -> return (LZero, False, total)"],"instances":[],"language":{"extensions":["OverloadedStrings","BangPatterns","NamedFieldPuns","MultiParamTypeClasses","NondecreasingIndentation","ExplicitForAll","PatternGuards"],"isInstance":false}}