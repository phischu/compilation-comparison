{"sliceID":6830589594641922584,"uses":[{"reference":{"otherSlice":7847819776717226819},"usedName":{"typeName":{"identifier":"MArray"}},"qualification":"A"},{"reference":{"builtinModule":"GHC.Types"},"usedName":{"typeName":{"identifier":"Int"}},"qualification":null},{"reference":{"builtinModule":"GHC.Types"},"usedName":{"typeName":{"identifier":"Char"}},"qualification":null},{"reference":{"builtinModule":"GHC.ST"},"usedName":{"typeName":{"identifier":"ST"}},"qualification":null},{"reference":{"builtinModule":"GHC.Classes"},"usedName":{"valueName":{"operator":"<"}},"qualification":null},{"reference":{"otherSlice":7073776594548819763},"usedName":{"valueName":{"identifier":"unsafeWrite"}},"qualification":"A"},{"reference":{"builtinModule":"GHC.Real"},"usedName":{"valueName":{"identifier":"fromIntegral"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"identifier":"return"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"identifier":"otherwise"}},"qualification":null},{"reference":{"builtinModule":"GHC.Num"},"usedName":{"valueName":{"operator":"+"}},"qualification":null},{"reference":{"otherSlice":7488690057018853220},"usedName":{"valueName":{"identifier":"ord"}},"qualification":null},{"reference":{"builtinModule":"GHC.Num"},"usedName":{"valueName":{"operator":"-"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"operator":"$"}},"qualification":null},{"reference":{"otherSlice":7358425231838581354},"usedName":{"valueName":{"identifier":"shiftR"}},"qualification":null},{"reference":{"builtinModule":"Data.Bits"},"usedName":{"valueName":{"operator":".&."}},"qualification":null}],"fragment":["unsafeWrite :: A.MArray s -> Int -> Char -> ST s Int","unsafeWrite marr i c\n  | n < 65536 =\n    do A.unsafeWrite marr i (fromIntegral n)\n       return 1\n  | otherwise =\n    do A.unsafeWrite marr i lo\n       A.unsafeWrite marr (i + 1) hi\n       return 2\n  where n = ord c\n        m = n - 65536\n        lo = fromIntegral $ (m `shiftR` 10) + 55296\n        hi = fromIntegral $ (m .&. 1023) + 56320"],"instances":[],"language":{"extensions":["MagicHash","MultiParamTypeClasses","NondecreasingIndentation","ExplicitForAll","PatternGuards"],"isInstance":false}}