{"sliceID":2966664413417440160,"uses":[{"reference":{"otherSlice":1546470151414195006},"usedName":{"typeName":{"identifier":"Socket"}},"qualification":null},{"reference":{"otherSlice":1263632250898005386},"usedName":{"typeName":{"identifier":"RecvBuf"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"identifier":"return"}},"qualification":null},{"reference":{"builtinModule":"GHC.Types"},"usedName":{"constructorName":{"identifier":"True"},"constructorTypeName":{"identifier":"Bool"}},"qualification":null},{"reference":{"builtinModule":"GHC.Real"},"usedName":{"valueName":{"identifier":"fromIntegral"}},"qualification":null},{"reference":{"builtinModule":"Data.Functor"},"usedName":{"valueName":{"operator":"<$>"}},"qualification":null},{"reference":{"otherSlice":5171062795299820475},"usedName":{"valueName":{"identifier":"receiveloop"}},"qualification":null},{"reference":{"builtinModule":"GHC.Classes"},"usedName":{"valueName":{"operator":"=="}},"qualification":null},{"reference":{"builtinModule":"GHC.Types"},"usedName":{"constructorName":{"identifier":"False"},"constructorTypeName":{"identifier":"Bool"}},"qualification":null},{"reference":{"builtinModule":"GHC.Ptr"},"usedName":{"valueName":{"identifier":"plusPtr"}},"qualification":null},{"reference":{"builtinModule":"GHC.Num"},"usedName":{"valueName":{"operator":"-"}},"qualification":null},{"reference":{"otherSlice":8958771362787954005},"usedName":{"valueName":{"identifier":"fdSocket"}},"qualification":null}],"fragment":["receiveBuf :: Socket -> RecvBuf","receiveBuf sock buf0 siz0 = loop buf0 siz0\n  where loop _ 0 = return True\n        loop buf siz\n          = do n <- fromIntegral <$> receiveloop fd buf (fromIntegral siz)\n               if n == 0 then return False else loop (buf `plusPtr` n) (siz - n)\n        fd = fdSocket sock"],"instances":[],"language":{"extensions":["ForeignFunctionInterface","OverloadedStrings","MultiParamTypeClasses","NondecreasingIndentation","ExplicitForAll","PatternGuards"],"isInstance":false}}