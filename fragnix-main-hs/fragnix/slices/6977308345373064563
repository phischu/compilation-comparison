{"sliceID":6977308345373064563,"uses":[{"reference":{"otherSlice":2506128889369845069},"usedName":{"valueName":{"identifier":"getFileStatus"}},"qualification":null},{"reference":{"builtinModule":"GHC.Classes"},"usedName":{"valueName":{"identifier":"not"}},"qualification":null},{"reference":{"otherSlice":6466939128301314969},"usedName":{"valueName":{"identifier":"isDirectory"}},"qualification":null},{"reference":{"otherSlice":1297624643245265756},"usedName":{"valueName":{"identifier":"fileMode"}},"qualification":null},{"reference":{"otherSlice":5365736941049221963},"usedName":{"valueName":{"identifier":"intersectFileModes"}},"qualification":null},{"reference":{"otherSlice":8135720061182606180},"usedName":{"valueName":{"identifier":"ownerReadMode"}},"qualification":null},{"reference":{"builtinModule":"GHC.Classes"},"usedName":{"valueName":{"operator":"/="}},"qualification":null},{"reference":{"builtinModule":"GHC.Classes"},"usedName":{"valueName":{"operator":"&&"}},"qualification":null},{"reference":{"otherSlice":7453563131750876375},"usedName":{"valueName":{"identifier":"epochTimeToHTTPDate"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"operator":"$"}},"qualification":null},{"reference":{"otherSlice":2648661393694550600},"usedName":{"valueName":{"identifier":"modificationTime"}},"qualification":null},{"reference":{"otherSlice":3981319745955066275},"usedName":{"valueName":{"identifier":"formatHTTPDate"}},"qualification":null},{"reference":{"builtinModule":"GHC.Real"},"usedName":{"valueName":{"identifier":"fromIntegral"}},"qualification":null},{"reference":{"otherSlice":919706005511708302},"usedName":{"valueName":{"identifier":"fileSize"}},"qualification":null},{"reference":{"otherSlice":6031488408124747280},"usedName":{"constructorName":{"identifier":"FileInfo"},"constructorTypeName":{"identifier":"FileInfo"}},"qualification":null},{"reference":{"otherSlice":6031488408124747280},"usedName":{"valueName":{"identifier":"fileInfoName"}},"qualification":null},{"reference":{"otherSlice":6031488408124747280},"usedName":{"valueName":{"identifier":"fileInfoSize"}},"qualification":null},{"reference":{"otherSlice":6031488408124747280},"usedName":{"valueName":{"identifier":"fileInfoTime"}},"qualification":null},{"reference":{"otherSlice":6031488408124747280},"usedName":{"valueName":{"identifier":"fileInfoDate"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"identifier":"return"}},"qualification":null},{"reference":{"builtinModule":"GHC.IO"},"usedName":{"valueName":{"identifier":"throwIO"}},"qualification":null},{"reference":{"builtinModule":"GHC.IO.Exception"},"usedName":{"valueName":{"identifier":"userError"}},"qualification":null},{"reference":{"builtinModule":"GHC.IO"},"usedName":{"typeName":{"identifier":"FilePath"}},"qualification":null},{"reference":{"builtinModule":"GHC.Types"},"usedName":{"typeName":{"identifier":"IO"}},"qualification":null},{"reference":{"otherSlice":6031488408124747280},"usedName":{"typeName":{"identifier":"FileInfo"}},"qualification":null}],"fragment":["getInfo :: FilePath -> IO FileInfo","getInfo path\n  = do fs <- getFileStatus path\n       let regular = not (isDirectory fs)\n           readable = fileMode fs `intersectFileModes` ownerReadMode /= 0\n       if regular && readable then\n         do let time = epochTimeToHTTPDate $ modificationTime fs\n                date = formatHTTPDate time\n                size = fromIntegral $ fileSize fs\n                info\n                  = FileInfo{fileInfoName = path, fileInfoSize = size,\n                             fileInfoTime = time, fileInfoDate = date}\n            return info\n         else throwIO (userError \"FileInfoCache:getInfo\")"],"instances":[],"language":{"extensions":["RecordWildCards","MultiParamTypeClasses","NondecreasingIndentation","ExplicitForAll","PatternGuards"],"isInstance":false}}