{"sliceID":5152940835766549160,"uses":[{"reference":{"otherSlice":3507186649217828093},"usedName":{"typeName":{"identifier":"ParseTime"}},"qualification":null},{"reference":{"otherSlice":3513222745602344190},"usedName":{"typeName":{"identifier":"Day"}},"qualification":null},{"reference":{"otherSlice":3507186649217828093},"usedName":{"valueName":{"identifier":"buildTime"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"operator":"."}},"qualification":null},{"reference":{"builtinModule":"GHC.List"},"usedName":{"valueName":{"identifier":"concatMap"}},"qualification":null},{"reference":{"builtinModule":"Data.Tuple"},"usedName":{"valueName":{"identifier":"uncurry"}},"qualification":null},{"reference":{"otherSlice":5758058993081773797},"usedName":{"constructorName":{"identifier":"Century"},"constructorTypeName":{"identifier":"DayComponent"}},"qualification":null},{"reference":{"builtinModule":"Text.Read"},"usedName":{"valueName":{"identifier":"read"}},"qualification":null},{"reference":{"builtinModule":"GHC.Real"},"usedName":{"valueName":{"identifier":"div"}},"qualification":null},{"reference":{"otherSlice":5758058993081773797},"usedName":{"constructorName":{"identifier":"CenturyYear"},"constructorTypeName":{"identifier":"DayComponent"}},"qualification":null},{"reference":{"builtinModule":"GHC.Real"},"usedName":{"valueName":{"identifier":"mod"}},"qualification":null},{"reference":{"otherSlice":5758058993081773797},"usedName":{"constructorName":{"identifier":"YearMonth"},"constructorTypeName":{"identifier":"DayComponent"}},"qualification":null},{"reference":{"builtinModule":"GHC.Num"},"usedName":{"valueName":{"operator":"+"}},"qualification":null},{"reference":{"builtinModule":"Data.Maybe"},"usedName":{"valueName":{"identifier":"fromJust"}},"qualification":null},{"reference":{"builtinModule":"Data.List"},"usedName":{"valueName":{"identifier":"elemIndex"}},"qualification":null},{"reference":{"otherSlice":8054163582920169744},"usedName":{"valueName":{"identifier":"up"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"identifier":"map"}},"qualification":null},{"reference":{"builtinModule":"Data.Tuple"},"usedName":{"valueName":{"identifier":"fst"}},"qualification":null},{"reference":{"otherSlice":2448737557573459507},"usedName":{"valueName":{"identifier":"months"}},"qualification":null},{"reference":{"builtinModule":"Data.Tuple"},"usedName":{"valueName":{"identifier":"snd"}},"qualification":null},{"reference":{"otherSlice":5758058993081773797},"usedName":{"constructorName":{"identifier":"MonthDay"},"constructorTypeName":{"identifier":"DayComponent"}},"qualification":null},{"reference":{"otherSlice":5758058993081773797},"usedName":{"constructorName":{"identifier":"YearWeek"},"constructorTypeName":{"identifier":"DayComponent"}},"qualification":null},{"reference":{"otherSlice":5545460935144387602},"usedName":{"constructorName":{"identifier":"ISOWeek"},"constructorTypeName":{"identifier":"WeekType"}},"qualification":null},{"reference":{"otherSlice":5545460935144387602},"usedName":{"constructorName":{"identifier":"SundayWeek"},"constructorTypeName":{"identifier":"WeekType"}},"qualification":null},{"reference":{"otherSlice":5545460935144387602},"usedName":{"constructorName":{"identifier":"MondayWeek"},"constructorTypeName":{"identifier":"WeekType"}},"qualification":null},{"reference":{"otherSlice":5758058993081773797},"usedName":{"constructorName":{"identifier":"WeekDay"},"constructorTypeName":{"identifier":"DayComponent"}},"qualification":null},{"reference":{"otherSlice":2448737557573459507},"usedName":{"valueName":{"identifier":"wDays"}},"qualification":null},{"reference":{"otherSlice":5758058993081773797},"usedName":{"constructorName":{"identifier":"YearDay"},"constructorTypeName":{"identifier":"DayComponent"}},"qualification":null},{"reference":{"builtinModule":"GHC.Classes"},"usedName":{"valueName":{"operator":">="}},"qualification":null},{"reference":{"builtinModule":"GHC.Num"},"usedName":{"valueName":{"operator":"*"}},"qualification":null},{"reference":{"otherSlice":6486583220808923577},"usedName":{"valueName":{"identifier":"fromGregorian"}},"qualification":null},{"reference":{"otherSlice":4837188226587690670},"usedName":{"valueName":{"identifier":"fromOrdinalDate"}},"qualification":null},{"reference":{"otherSlice":4095129413753488182},"usedName":{"valueName":{"identifier":"fromWeekDate"}},"qualification":null},{"reference":{"otherSlice":4093374465136451965},"usedName":{"valueName":{"identifier":"fromSundayStartWeek"}},"qualification":null},{"reference":{"otherSlice":5995531052243901688},"usedName":{"valueName":{"identifier":"fromMondayStartWeek"}},"qualification":null},{"reference":{"builtinModule":"GHC.List"},"usedName":{"valueName":{"identifier":"last"}},"qualification":null}],"fragment":["instance ParseTime Day where\n        buildTime l = buildDay . concatMap (uncurry f)\n          where f c x\n                  = case c of\n                        'C' -> [Century (read x)]\n                        'f' -> [Century (read x)]\n                        'Y' -> let y = read x in\n                                 [Century (y `div` 100), CenturyYear (y `mod` 100)]\n                        'G' -> let y = read x in\n                                 [Century (y `div` 100), CenturyYear (y `mod` 100)]\n                        'y' -> [CenturyYear (read x)]\n                        'g' -> [CenturyYear (read x)]\n                        'B' -> [YearMonth\n                                  (1 + fromJust (elemIndex (up x) (map (up . fst) (months l))))]\n                        'b' -> [YearMonth\n                                  (1 + fromJust (elemIndex (up x) (map (up . snd) (months l))))]\n                        'm' -> [YearMonth (read x)]\n                        'd' -> [MonthDay (read x)]\n                        'e' -> [MonthDay (read x)]\n                        'V' -> [YearWeek ISOWeek (read x)]\n                        'U' -> [YearWeek SundayWeek (read x)]\n                        'W' -> [YearWeek MondayWeek (read x)]\n                        'u' -> [WeekDay (read x)]\n                        'a' -> [WeekDay\n                                  (1 +\n                                     (fromJust (elemIndex (up x) (map (up . snd) (wDays l))) + 6)\n                                       `mod` 7)]\n                        'A' -> [WeekDay\n                                  (1 +\n                                     (fromJust (elemIndex (up x) (map (up . fst) (wDays l))) + 6)\n                                       `mod` 7)]\n                        'w' -> [WeekDay (((read x + 6) `mod` 7) + 1)]\n                        'j' -> [YearDay (read x)]\n                        _ -> []\n                buildDay cs = rest cs\n                  where y = let d = safeLast 70 [x | CenturyYear x <- cs]\n                                c = safeLast (if d >= 69 then 19 else 20) [x | Century x <- cs]\n                              in 100 * c + d\n                        rest (YearMonth m : _)\n                          = let d = safeLast 1 [x | MonthDay x <- cs] in fromGregorian y m d\n                        rest (YearDay d : _) = fromOrdinalDate y d\n                        rest (YearWeek wt w : _)\n                          = let d = safeLast 4 [x | WeekDay x <- cs] in\n                              case wt of\n                                  ISOWeek -> fromWeekDate y w d\n                                  SundayWeek -> fromSundayStartWeek y w (d `mod` 7)\n                                  MondayWeek -> fromMondayStartWeek y w d\n                        rest (_ : xs) = rest xs\n                        rest [] = rest [YearMonth 1]\n                safeLast x xs = last (x : xs)"],"instances":[],"language":{"extensions":["Rank2Types","DeriveDataTypeable","StandaloneDeriving","MultiParamTypeClasses","NondecreasingIndentation","ExplicitForAll","PatternGuards"],"isInstance":true}}