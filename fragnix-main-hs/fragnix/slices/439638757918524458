{"sliceID":439638757918524458,"uses":[{"reference":{"otherSlice":4512247588159674237},"usedName":{"valueName":{"identifier":"sumEncoding"}},"qualification":null},{"reference":{"otherSlice":2490827399793063090},"usedName":{"constructorName":{"identifier":"TwoElemArray"},"constructorTypeName":{"identifier":"SumEncoding"}},"qualification":null},{"reference":{"otherSlice":1099420853876450354},"usedName":{"valueName":{"identifier":"array"}},"qualification":null},{"reference":{"otherSlice":6390671972622275302},"usedName":{"valueName":{"identifier":"encStr"}},"qualification":null},{"reference":{"otherSlice":4468210030402328315},"usedName":{"valueName":{"operator":"<%>"}},"qualification":null},{"reference":{"otherSlice":2490827399793063090},"usedName":{"constructorName":{"identifier":"TaggedObject"},"constructorTypeName":{"identifier":"SumEncoding"}},"qualification":null},{"reference":{"otherSlice":2490827399793063090},"usedName":{"valueName":{"identifier":"tagFieldName"}},"qualification":null},{"reference":{"otherSlice":2490827399793063090},"usedName":{"valueName":{"identifier":"contentsFieldName"}},"qualification":null},{"reference":{"otherSlice":2048067546703867103},"usedName":{"valueName":{"identifier":"text"}},"qualification":"E"},{"reference":{"otherSlice":5420555374589246121},"usedName":{"valueName":{"identifier":"pack"}},"qualification":"T"},{"reference":{"otherSlice":8859284081890533327},"usedName":{"valueName":{"operator":"<:>"}},"qualification":null},{"reference":{"otherSlice":5507919707442773556},"usedName":{"valueName":{"identifier":"object"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"operator":"$"}},"qualification":null},{"reference":{"otherSlice":2490827399793063090},"usedName":{"constructorName":{"identifier":"ObjectWithSingleField"},"constructorTypeName":{"identifier":"SumEncoding"}},"qualification":null},{"reference":{"otherSlice":2490827399793063090},"usedName":{"constructorName":{"identifier":"UntaggedValue"},"constructorTypeName":{"identifier":"SumEncoding"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"identifier":"otherwise"}},"qualification":null},{"reference":{"otherSlice":4512247588159674237},"usedName":{"typeName":{"identifier":"Options"}},"qualification":null},{"reference":{"builtinModule":"GHC.Types"},"usedName":{"typeName":{"identifier":"Bool"}},"qualification":null}],"fragment":["sumToEncoding :: Options -> Bool -> Bool -> Name -> Q Exp -> Q Exp","sumToEncoding opts multiCons nullary conName exp\n  | multiCons =\n    let fexp = exp in\n      case sumEncoding opts of\n          TwoElemArray -> array (encStr opts conName <%> fexp)\n          TaggedObject{tagFieldName, contentsFieldName} -> let tag\n                                                                 = [| E.text (T.pack tagFieldName)\n                                                                     |]\n                                                                     <:> encStr opts conName\n                                                               contents\n                                                                 = [|\n                                                                     E.text\n                                                                       (T.pack contentsFieldName)\n                                                                     |]\n                                                                     <:> fexp\n                                                             in\n                                                             object $\n                                                               if nullary then tag else\n                                                                 tag <%> contents\n          ObjectWithSingleField -> object (encStr opts conName <:> fexp)\n          UntaggedValue | nullary -> encStr opts conName\n          UntaggedValue -> exp\n  | otherwise = exp"],"instances":[],"language":{"extensions":["BangPatterns","FlexibleInstances","NamedFieldPuns","NoImplicitPrelude","UndecidableInstances","TemplateHaskellQuotes","MultiParamTypeClasses","NondecreasingIndentation","ExplicitForAll","PatternGuards","TemplateHaskell"],"isInstance":false}}