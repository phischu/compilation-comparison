{"sliceID":6823175524856199384,"uses":[{"reference":{"otherSlice":6754066338397186803},"usedName":{"valueName":{"identifier":"withFreePort"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"operator":"$"}},"qualification":null},{"reference":{"otherSlice":8034790104569133796},"usedName":{"valueName":{"identifier":"mkWaiter"}},"qualification":null},{"reference":{"otherSlice":135941937043906956},"usedName":{"valueName":{"identifier":"settingsBeforeMainLoop"}},"qualification":null},{"reference":{"otherSlice":3229478168049735109},"usedName":{"valueName":{"identifier":"notify"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"operator":">>"}},"qualification":null},{"reference":{"otherSlice":1376777678018664540},"usedName":{"valueName":{"identifier":"race"}},"qualification":null},{"reference":{"otherSlice":8784208075139464912},"usedName":{"valueName":{"identifier":"runSettingsSocket"}},"qualification":null},{"reference":{"otherSlice":3229478168049735109},"usedName":{"valueName":{"identifier":"waitFor"}},"qualification":null},{"reference":{"builtinModule":"Data.Either"},"usedName":{"constructorName":{"identifier":"Left"},"constructorTypeName":{"identifier":"Either"}},"qualification":null},{"reference":{"builtinModule":"GHC.IO"},"usedName":{"valueName":{"identifier":"throwIO"}},"qualification":null},{"reference":{"builtinModule":"Data.Either"},"usedName":{"constructorName":{"identifier":"Right"},"constructorTypeName":{"identifier":"Either"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"identifier":"return"}},"qualification":null},{"reference":{"otherSlice":135941937043906956},"usedName":{"typeName":{"identifier":"Settings"}},"qualification":null},{"reference":{"builtinModule":"GHC.Types"},"usedName":{"typeName":{"identifier":"IO"}},"qualification":null},{"reference":{"otherSlice":2503338423706628106},"usedName":{"typeName":{"identifier":"Application"}},"qualification":null},{"reference":{"otherSlice":2598732416915737838},"usedName":{"typeName":{"identifier":"Port"}},"qualification":null}],"fragment":["withApplicationSettings ::\n                        Settings -> IO Application -> (Port -> IO a) -> IO a","withApplicationSettings settings' mkApp action\n  = do app <- mkApp\n       withFreePort $\n         \\ (port, sock) ->\n           do started <- mkWaiter\n              let settings\n                    = settings'{settingsBeforeMainLoop =\n                                  notify started () >> settingsBeforeMainLoop settings'}\n              result <- race (runSettingsSocket settings sock app)\n                          (waitFor started >> action port)\n              case result of\n                  Left () -> throwIO $\n                               ErrorCall \"Unexpected: runSettingsSocket exited\"\n                  Right x -> return x"],"instances":[],"language":{"extensions":["MultiParamTypeClasses","NondecreasingIndentation","ExplicitForAll","PatternGuards"],"isInstance":false}}