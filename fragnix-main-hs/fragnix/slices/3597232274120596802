{"sliceID":3597232274120596802,"uses":[{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"operator":"$"}},"qualification":null},{"reference":{"otherSlice":2494920314047720382},"usedName":{"valueName":{"identifier":"lookup"}},"qualification":"M"},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"constructorName":{"identifier":"Just"},"constructorTypeName":{"identifier":"Maybe"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"constructorName":{"identifier":"Nothing"},"constructorTypeName":{"identifier":"Maybe"}},"qualification":null},{"reference":{"otherSlice":8325092508733816738},"usedName":{"valueName":{"identifier":"jsonFunValOrListName"}},"qualification":null},{"reference":{"otherSlice":3966759638153104037},"usedName":{"constructorName":{"identifier":"Arity0"},"constructorTypeName":{"identifier":"Arity"}},"qualification":null},{"reference":{"builtinModule":"Data.List.NonEmpty"},"usedName":{"constructorName":{"operator":":|"},"constructorTypeName":{"identifier":"NonEmpty"}},"qualification":null},{"reference":{"otherSlice":3516407524677664167},"usedName":{"valueName":{"identifier":"unapplyTy"}},"qualification":null},{"reference":{"builtinModule":"GHC.Types"},"usedName":{"typeName":{"identifier":"Int"}},"qualification":null},{"reference":{"builtinModule":"GHC.Classes"},"usedName":{"valueName":{"identifier":"min"}},"qualification":null},{"reference":{"otherSlice":4299504902901625159},"usedName":{"valueName":{"identifier":"arityInt"}},"qualification":null},{"reference":{"builtinModule":"Data.Foldable"},"usedName":{"valueName":{"identifier":"length"}},"qualification":null},{"reference":{"builtinModule":"GHC.List"},"usedName":{"valueName":{"identifier":"splitAt"}},"qualification":null},{"reference":{"builtinModule":"GHC.Num"},"usedName":{"valueName":{"operator":"-"}},"qualification":null},{"reference":{"otherSlice":7179715165257321418},"usedName":{"valueName":{"identifier":"keys"}},"qualification":"M"},{"reference":{"otherSlice":7413892669819549304},"usedName":{"valueName":{"identifier":"isTyFamily"}},"qualification":null},{"reference":{"builtinModule":"Data.Foldable"},"usedName":{"valueName":{"identifier":"any"}},"qualification":null},{"reference":{"otherSlice":2136754132920722734},"usedName":{"valueName":{"identifier":"mentionsName"}},"qualification":null},{"reference":{"builtinModule":"GHC.Classes"},"usedName":{"valueName":{"operator":"||"}},"qualification":null},{"reference":{"builtinModule":"GHC.Classes"},"usedName":{"valueName":{"operator":"&&"}},"qualification":null},{"reference":{"otherSlice":2528201507926664230},"usedName":{"valueName":{"identifier":"outOfPlaceTyVarError"}},"qualification":null},{"reference":{"builtinModule":"GHC.Enum"},"usedName":{"valueName":{"identifier":"toEnum"}},"qualification":null},{"reference":{"builtinModule":"GHC.List"},"usedName":{"valueName":{"identifier":"zipWith"}},"qualification":null},{"reference":{"builtinModule":"GHC.List"},"usedName":{"valueName":{"identifier":"cycle"}},"qualification":null},{"reference":{"builtinModule":"GHC.Types"},"usedName":{"constructorName":{"identifier":"False"},"constructorTypeName":{"identifier":"Bool"}},"qualification":null},{"reference":{"builtinModule":"GHC.Types"},"usedName":{"constructorName":{"identifier":"True"},"constructorTypeName":{"identifier":"Bool"}},"qualification":null},{"reference":{"otherSlice":163784499293869512},"usedName":{"valueName":{"identifier":"interleave"}},"qualification":null},{"reference":{"otherSlice":3790782889836978137},"usedName":{"typeName":{"identifier":"JSONClass"}},"qualification":null},{"reference":{"otherSlice":4804926165326574434},"usedName":{"typeName":{"identifier":"JSONFun"}},"qualification":null},{"reference":{"otherSlice":9113544377361668434},"usedName":{"typeName":{"identifier":"TyVarMap"}},"qualification":null},{"reference":{"builtinModule":"GHC.Types"},"usedName":{"typeName":{"identifier":"Bool"}},"qualification":null}],"fragment":["dispatchFunByType ::\n                  JSONClass -> JSONFun -> Name -> TyVarMap -> Bool -> Type -> Q Exp","dispatchFunByType _ jf _ tvMap list (VarT tyName)\n  = varE $\n      case M.lookup tyName tvMap of\n          Just (tfjExp, tfjlExp) -> if list then tfjlExp else tfjExp\n          Nothing -> jsonFunValOrListName list jf Arity0\ndispatchFunByType jc jf conName tvMap list (SigT ty _)\n  = dispatchFunByType jc jf conName tvMap list ty\ndispatchFunByType jc jf conName tvMap list (ForallT _ _ ty)\n  = dispatchFunByType jc jf conName tvMap list ty\ndispatchFunByType jc jf conName tvMap list ty\n  = do let tyCon :: Type\n           tyArgs :: [Type]\n           tyCon :| tyArgs = unapplyTy ty\n           numLastArgs :: Int\n           numLastArgs = min (arityInt jc) (length tyArgs)\n           lhsArgs, rhsArgs :: [Type]\n           (lhsArgs, rhsArgs) = splitAt (length tyArgs - numLastArgs) tyArgs\n           tyVarNames :: [Name]\n           tyVarNames = M.keys tvMap\n       itf <- isTyFamily tyCon\n       if\n         any (`mentionsName` tyVarNames) lhsArgs ||\n           itf && any (`mentionsName` tyVarNames) tyArgs\n         then outOfPlaceTyVarError jc conName else\n         if any (`mentionsName` tyVarNames) rhsArgs then\n           appsE $\n             varE (jsonFunValOrListName list jf $ toEnum numLastArgs) :\n               zipWith (dispatchFunByType jc jf conName tvMap)\n                 (cycle [False, True])\n                 (interleave rhsArgs rhsArgs)\n           else varE $ jsonFunValOrListName list jf Arity0"],"instances":[],"language":{"extensions":["BangPatterns","FlexibleInstances","NamedFieldPuns","NoImplicitPrelude","UndecidableInstances","TemplateHaskellQuotes","MultiParamTypeClasses","NondecreasingIndentation","ExplicitForAll","PatternGuards","TemplateHaskell"],"isInstance":false}}