{"sliceID":6164078285193811307,"uses":[{"reference":{"builtinModule":"GHC.IORef"},"usedName":{"valueName":{"identifier":"newIORef"}},"qualification":null},{"reference":{"builtinModule":"Data.Monoid"},"usedName":{"valueName":{"identifier":"mempty"}},"qualification":null},{"reference":{"builtinModule":"Data.IORef"},"usedName":{"valueName":{"identifier":"atomicModifyIORef"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"operator":"$"}},"qualification":null},{"reference":{"builtinModule":"Data.Monoid"},"usedName":{"valueName":{"identifier":"mappend"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"identifier":"return"}},"qualification":null},{"reference":{"builtinModule":"GHC.IORef"},"usedName":{"valueName":{"identifier":"readIORef"}},"qualification":null},{"reference":{"otherSlice":8839066667246436067},"usedName":{"valueName":{"identifier":"toLazyByteString"}},"qualification":null},{"reference":{"otherSlice":7183867508510876546},"usedName":{"valueName":{"identifier":"length"}},"qualification":"L"},{"reference":{"builtinModule":"GHC.Prim"},"usedName":{"valueName":{"identifier":"seq"}},"qualification":null},{"reference":{"builtinModule":"GHC.IORef"},"usedName":{"valueName":{"identifier":"writeIORef"}},"qualification":null},{"reference":{"otherSlice":3770287935488921004},"usedName":{"constructorName":{"identifier":"SResponse"},"constructorTypeName":{"identifier":"SResponse"}},"qualification":null},{"reference":{"otherSlice":303372933562511200},"usedName":{"constructorName":{"identifier":"ResponseReceived"},"constructorTypeName":{"identifier":"ResponseReceived"}},"qualification":null},{"reference":{"otherSlice":498737198033065716},"usedName":{"valueName":{"identifier":"responseToStream"}},"qualification":null},{"reference":{"builtinModule":"GHC.IORef"},"usedName":{"typeName":{"identifier":"IORef"}},"qualification":null},{"reference":{"otherSlice":3770287935488921004},"usedName":{"typeName":{"identifier":"SResponse"}},"qualification":null},{"reference":{"otherSlice":4388261176215324957},"usedName":{"typeName":{"identifier":"Response"}},"qualification":null},{"reference":{"builtinModule":"GHC.Types"},"usedName":{"typeName":{"identifier":"IO"}},"qualification":null},{"reference":{"otherSlice":303372933562511200},"usedName":{"typeName":{"identifier":"ResponseReceived"}},"qualification":null}],"fragment":["runResponse :: IORef SResponse -> Response -> IO ResponseReceived","runResponse ref res\n  = do refBuilder <- newIORef mempty\n       let add y\n             = atomicModifyIORef refBuilder $ \\ x -> (x `mappend` y, ())\n       withBody $ \\ body -> body add (return ())\n       builder <- readIORef refBuilder\n       let lbs = toLazyByteString builder\n           len = L.length lbs\n       seq len $ writeIORef ref $ SResponse s h $ toLazyByteString builder\n       return ResponseReceived\n  where (s, h, withBody) = responseToStream res"],"instances":[],"language":{"extensions":["OverloadedStrings","DeriveDataTypeable","MultiParamTypeClasses","NondecreasingIndentation","ExplicitForAll","PatternGuards"],"isInstance":false}}