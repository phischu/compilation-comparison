{"sliceID":2658090676192341942,"uses":[{"reference":{"otherSlice":1306416343409347104},"usedName":{"valueName":{"identifier":"newTQueueIO"}},"qualification":null},{"reference":{"builtinModule":"GHC.IORef"},"usedName":{"valueName":{"identifier":"newIORef"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"identifier":"return"}},"qualification":null},{"reference":{"otherSlice":1381755339532824507},"usedName":{"valueName":{"identifier":"initialize"}},"qualification":"T"},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"operator":"$"}},"qualification":null},{"reference":{"otherSlice":135941937043906956},"usedName":{"valueName":{"identifier":"settingsTimeout"}},"qualification":null},{"reference":{"builtinModule":"GHC.Num"},"usedName":{"valueName":{"operator":"*"}},"qualification":null},{"reference":{"builtinModule":"Data.Functor"},"usedName":{"valueName":{"identifier":"void"}},"qualification":null},{"reference":{"builtinModule":"GHC.Conc.Sync"},"usedName":{"valueName":{"identifier":"forkIO"}},"qualification":null},{"reference":{"otherSlice":5281408873611362228},"usedName":{"valueName":{"identifier":"empty"}},"qualification":"Set"},{"reference":{"otherSlice":7046325130647915595},"usedName":{"constructorName":{"identifier":"Manager"},"constructorTypeName":{"identifier":"Manager"}},"qualification":null},{"reference":{"builtinModule":"GHC.Conc.Sync"},"usedName":{"valueName":{"identifier":"atomically"}},"qualification":null},{"reference":{"otherSlice":6065381269424617342},"usedName":{"valueName":{"identifier":"readTQueue"}},"qualification":null},{"reference":{"otherSlice":7569348440560181743},"usedName":{"constructorName":{"identifier":"Stop"},"constructorTypeName":{"identifier":"Command"}},"qualification":null},{"reference":{"otherSlice":6264415112108708234},"usedName":{"valueName":{"identifier":"kill"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"operator":">>"}},"qualification":null},{"reference":{"otherSlice":4896749505250921710},"usedName":{"valueName":{"identifier":"killManager"}},"qualification":"T"},{"reference":{"otherSlice":7569348440560181743},"usedName":{"constructorName":{"identifier":"Spawn"},"constructorTypeName":{"identifier":"Command"}},"qualification":null},{"reference":{"otherSlice":7569348440560181743},"usedName":{"constructorName":{"identifier":"Add"},"constructorTypeName":{"identifier":"Command"}},"qualification":null},{"reference":{"otherSlice":5587137625532923154},"usedName":{"valueName":{"identifier":"add"}},"qualification":null},{"reference":{"otherSlice":7569348440560181743},"usedName":{"constructorName":{"identifier":"Delete"},"constructorTypeName":{"identifier":"Command"}},"qualification":null},{"reference":{"otherSlice":2059282727252623444},"usedName":{"valueName":{"identifier":"del"}},"qualification":null},{"reference":{"builtinModule":"GHC.IORef"},"usedName":{"valueName":{"identifier":"readIORef"}},"qualification":null},{"reference":{"otherSlice":135941937043906956},"usedName":{"typeName":{"identifier":"Settings"}},"qualification":null},{"reference":{"builtinModule":"GHC.Types"},"usedName":{"typeName":{"identifier":"IO"}},"qualification":null},{"reference":{"otherSlice":7046325130647915595},"usedName":{"typeName":{"identifier":"Manager"}},"qualification":null}],"fragment":["start :: Settings -> IO Manager","start set\n  = do q <- newTQueueIO\n       ref <- newIORef (\\ _ -> return ())\n       timmgr <- T.initialize $ settingsTimeout set * 1000000\n       void $ forkIO $ go q Set.empty ref timmgr\n       return $ Manager q ref\n  where go q !tset0 ref timmgr\n          = do x <- atomically $ readTQueue q\n               case x of\n                   Stop -> kill tset0 >> T.killManager timmgr\n                   Spawn -> next tset0\n                   Add newtid -> let !tset = add newtid tset0 in go q tset ref timmgr\n                   Delete oldtid -> let !tset = del oldtid tset0 in\n                                      go q tset ref timmgr\n          where next tset\n                  = do action <- readIORef ref\n                       newtid <- forkIO (action timmgr)\n                       let !tset' = add newtid tset\n                       go q tset' ref timmgr"],"instances":[],"language":{"extensions":["BangPatterns","MultiParamTypeClasses","NondecreasingIndentation","ExplicitForAll","PatternGuards"],"isInstance":false}}