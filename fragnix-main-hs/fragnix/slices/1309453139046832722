{"sliceID":1309453139046832722,"uses":[{"reference":{"builtinModule":"GHC.IO.Handle.Types"},"usedName":{"constructorName":{"identifier":"Handle__"},"constructorTypeName":{"identifier":"Handle__"}},"qualification":null},{"reference":{"builtinModule":"GHC.IO.Handle.Types"},"usedName":{"valueName":{"identifier":"haCharBuffer"}},"qualification":null},{"reference":{"builtinModule":"GHC.IO.Handle.Types"},"usedName":{"valueName":{"identifier":"haBuffers"}},"qualification":null},{"reference":{"builtinModule":"GHC.IO.Handle.Types"},"usedName":{"valueName":{"identifier":"haBufferMode"}},"qualification":null},{"reference":{"builtinModule":"GHC.IO.Handle.Types"},"usedName":{"constructorName":{"identifier":"NoBuffering"},"constructorTypeName":{"identifier":"BufferMode"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"identifier":"return"}},"qualification":null},{"reference":{"builtinModule":"GHC.Err"},"usedName":{"valueName":{"identifier":"error"}},"qualification":null},{"reference":{"builtinModule":"GHC.IORef"},"usedName":{"valueName":{"identifier":"readIORef"}},"qualification":null},{"reference":{"builtinModule":"GHC.IO.Handle.Types"},"usedName":{"constructorName":{"identifier":"BufferListCons"},"constructorTypeName":{"identifier":"BufferList"}},"qualification":null},{"reference":{"builtinModule":"GHC.IORef"},"usedName":{"valueName":{"identifier":"writeIORef"}},"qualification":null},{"reference":{"builtinModule":"GHC.IO.Buffer"},"usedName":{"valueName":{"identifier":"emptyBuffer"}},"qualification":null},{"reference":{"builtinModule":"GHC.IO.Buffer"},"usedName":{"valueName":{"identifier":"bufSize"}},"qualification":null},{"reference":{"builtinModule":"GHC.IO.Buffer"},"usedName":{"constructorName":{"identifier":"WriteBuffer"},"constructorTypeName":{"identifier":"BufferState"}},"qualification":null},{"reference":{"builtinModule":"GHC.IO.Handle.Types"},"usedName":{"constructorName":{"identifier":"BufferListNil"},"constructorTypeName":{"identifier":"BufferList"}},"qualification":null},{"reference":{"builtinModule":"GHC.IO.Buffer"},"usedName":{"valueName":{"identifier":"newCharBuffer"}},"qualification":null},{"reference":{"builtinModule":"GHC.IO.Handle.Types"},"usedName":{"typeName":{"identifier":"Handle__"}},"qualification":null},{"reference":{"builtinModule":"GHC.Types"},"usedName":{"typeName":{"identifier":"IO"}},"qualification":null},{"reference":{"builtinModule":"GHC.IO.Handle.Types"},"usedName":{"typeName":{"identifier":"BufferMode"}},"qualification":null},{"reference":{"builtinModule":"GHC.IO.Buffer"},"usedName":{"typeName":{"identifier":"CharBuffer"}},"qualification":null}],"fragment":["getSpareBuffer :: Handle__ -> IO (BufferMode, CharBuffer)","getSpareBuffer\n  Handle__{haCharBuffer = ref, haBuffers = spare_ref,\n           haBufferMode = mode}\n  = do case mode of\n           NoBuffering -> return (mode, error \"no buffer!\")\n           _ -> do bufs <- readIORef spare_ref\n                   buf <- readIORef ref\n                   case bufs of\n                       BufferListCons b rest -> do writeIORef spare_ref rest\n                                                   return\n                                                     (mode, emptyBuffer b (bufSize buf) WriteBuffer)\n                       BufferListNil -> do new_buf <- newCharBuffer (bufSize buf)\n                                                        WriteBuffer\n                                           return (mode, new_buf)"],"instances":[],"language":{"extensions":["BangPatterns","RecordWildCards","ScopedTypeVariables","MultiParamTypeClasses","NondecreasingIndentation","ExplicitForAll","PatternGuards"],"isInstance":false}}