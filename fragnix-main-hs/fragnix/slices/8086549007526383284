{"sliceID":8086549007526383284,"uses":[{"reference":{"otherSlice":8862722746729955054},"usedName":{"valueName":{"identifier":"builder"}},"qualification":null},{"reference":{"otherSlice":38613747648554582},"usedName":{"constructorName":{"identifier":"BufferRange"},"constructorTypeName":{"identifier":"BufferRange"}},"qualification":null},{"reference":{"builtinModule":"GHC.Ptr"},"usedName":{"valueName":{"identifier":"plusPtr"}},"qualification":null},{"reference":{"builtinModule":"GHC.Classes"},"usedName":{"valueName":{"operator":"<="}},"qualification":null},{"reference":{"otherSlice":1402340817036728862},"usedName":{"valueName":{"identifier":"runPoke"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"identifier":"otherwise"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"identifier":"return"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"operator":"$"}},"qualification":null},{"reference":{"otherSlice":4630681137417404139},"usedName":{"valueName":{"identifier":"bufferFull"}},"qualification":null},{"reference":{"otherSlice":3731036879417106745},"usedName":{"constructorName":{"identifier":"Write"},"constructorTypeName":{"identifier":"Write"}},"qualification":null},{"reference":{"otherSlice":3731036879417106745},"usedName":{"typeName":{"identifier":"Write"}},"qualification":null},{"reference":{"otherSlice":4322896446757888605},"usedName":{"typeName":{"identifier":"Builder"}},"qualification":null}],"fragment":["fromWriteSingleton :: (a -> Write) -> (a -> Builder)","fromWriteSingleton write = mkBuilder\n  where mkBuilder x = builder step\n          where step k (BufferRange op ope)\n                  | op `plusPtr` maxSize <= ope =\n                    do op' <- runPoke wio op\n                       let !br' = BufferRange op' ope\n                       k br'\n                  | otherwise = return $ bufferFull maxSize op (step k)\n                  where Write maxSize wio = write x"],"instances":[],"language":{"extensions":["BangPatterns","MultiParamTypeClasses","NondecreasingIndentation","ExplicitForAll","PatternGuards"],"isInstance":false}}