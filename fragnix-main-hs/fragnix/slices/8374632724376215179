{"sliceID":8374632724376215179,"uses":[{"reference":{"otherSlice":8748167810724547885},"usedName":{"constructorName":{"identifier":"WorkingBuffer"},"constructorTypeName":{"identifier":"WorkingBuffer"}},"qualification":null},{"reference":{"otherSlice":8748167810724547885},"usedName":{"valueName":{"identifier":"limit"}},"qualification":null},{"reference":{"otherSlice":8748167810724547885},"usedName":{"valueName":{"identifier":"offset"}},"qualification":null},{"reference":{"otherSlice":8748167810724547885},"usedName":{"valueName":{"identifier":"start"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"identifier":"return"}},"qualification":null},{"reference":{"builtinModule":"GHC.IORef"},"usedName":{"valueName":{"identifier":"readIORef"}},"qualification":null},{"reference":{"builtinModule":"GHC.Ptr"},"usedName":{"valueName":{"identifier":"plusPtr"}},"qualification":null},{"reference":{"builtinModule":"GHC.Classes"},"usedName":{"valueName":{"operator":">="}},"qualification":null},{"reference":{"builtinModule":"GHC.IO"},"usedName":{"valueName":{"identifier":"throwIO"}},"qualification":null},{"reference":{"otherSlice":3210954324554976950},"usedName":{"constructorName":{"identifier":"BufferOverrun"},"constructorTypeName":{"identifier":"BufferOverrun"}},"qualification":null},{"reference":{"builtinModule":"GHC.Classes"},"usedName":{"valueName":{"operator":"<"}},"qualification":null},{"reference":{"builtinModule":"GHC.Num"},"usedName":{"valueName":{"identifier":"negate"}},"qualification":null},{"reference":{"builtinModule":"GHC.IORef"},"usedName":{"valueName":{"identifier":"writeIORef"}},"qualification":null},{"reference":{"otherSlice":7140848239145789393},"usedName":{"typeName":{"identifier":"Buffer"}},"qualification":null},{"reference":{"builtinModule":"GHC.Types"},"usedName":{"typeName":{"identifier":"Int"}},"qualification":null},{"reference":{"builtinModule":"GHC.Types"},"usedName":{"typeName":{"identifier":"IO"}},"qualification":null},{"reference":{"builtinModule":"Foreign.Storable"},"usedName":{"valueName":{"identifier":"peek"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"operator":">>="}},"qualification":null},{"reference":{"builtinModule":"Foreign.Storable"},"usedName":{"valueName":{"identifier":"poke"}},"qualification":null},{"reference":{"builtinModule":"GHC.Num"},"usedName":{"valueName":{"operator":"-"}},"qualification":null},{"reference":{"otherSlice":8748167810724547885},"usedName":{"typeName":{"identifier":"WorkingBuffer"}},"qualification":null}],"fragment":["shiftLastN :: WorkingBuffer -> Int -> Int -> IO ()","shiftLastN WorkingBuffer{..} 0 _ = return ()\nshiftLastN WorkingBuffer{..} i len\n  = do ptr <- readIORef offset\n       let !ptr' = ptr `plusPtr` i\n       if ptr' >= limit then throwIO BufferOverrun else\n         if i < 0 then\n           do let !src = ptr `plusPtr` negate len\n                  !dst = src `plusPtr` i\n              shiftLeft dst src len\n              writeIORef offset ptr'\n           else\n           do let !src = ptr `plusPtr` (-1)\n                  !dst = ptr' `plusPtr` (-1)\n              shiftRight dst src len\n              writeIORef offset ptr'\n  where shiftLeft :: Buffer -> Buffer -> Int -> IO ()\n        shiftLeft _ _ 0 = return ()\n        shiftLeft !dst !src n\n          = do peek src >>= poke dst\n               shiftLeft (dst `plusPtr` 1) (src `plusPtr` 1) (n - 1)\n        \n        shiftRight :: Buffer -> Buffer -> Int -> IO ()\n        shiftRight _ _ 0 = return ()\n        shiftRight !dst !src n\n          = do peek src >>= poke dst\n               shiftRight (dst `plusPtr` (-1)) (src `plusPtr` (-1)) (n - 1)"],"instances":[],"language":{"extensions":["BangPatterns","RecordWildCards","MultiParamTypeClasses","NondecreasingIndentation","ExplicitForAll","PatternGuards"],"isInstance":false}}