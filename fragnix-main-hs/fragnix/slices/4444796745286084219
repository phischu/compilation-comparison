{"sliceID":4444796745286084219,"uses":[{"reference":{"otherSlice":8154511139228787414},"usedName":{"constructorName":{"identifier":"LoggerSet"},"constructorTypeName":{"identifier":"LoggerSet"}},"qualification":null},{"reference":{"builtinModule":"GHC.Arr"},"usedName":{"valueName":{"identifier":"bounds"}},"qualification":null},{"reference":{"builtinModule":"GHC.IORef"},"usedName":{"valueName":{"identifier":"readIORef"}},"qualification":null},{"reference":{"builtinModule":"Control.Monad"},"usedName":{"valueName":{"identifier":"mapM_"}},"qualification":null},{"reference":{"builtinModule":"Control.Monad"},"usedName":{"valueName":{"identifier":"when"}},"qualification":null},{"reference":{"builtinModule":"Data.Maybe"},"usedName":{"valueName":{"identifier":"isJust"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"operator":"$"}},"qualification":null},{"reference":{"builtinModule":"GHC.IO.Device"},"usedName":{"valueName":{"identifier":"close"}},"qualification":null},{"reference":{"otherSlice":6649867546510541993},"usedName":{"valueName":{"identifier":"flushLog"}},"qualification":null},{"reference":{"builtinModule":"GHC.Arr"},"usedName":{"valueName":{"operator":"!"}},"qualification":null},{"reference":{"otherSlice":3085819379153306263},"usedName":{"constructorName":{"identifier":"Logger"},"constructorTypeName":{"identifier":"Logger"}},"qualification":null},{"reference":{"builtinModule":"GHC.MVar"},"usedName":{"valueName":{"identifier":"takeMVar"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"operator":">>="}},"qualification":null},{"reference":{"otherSlice":6593246465973340024},"usedName":{"valueName":{"identifier":"freeBuffer"}},"qualification":null},{"reference":{"otherSlice":8154511139228787414},"usedName":{"typeName":{"identifier":"LoggerSet"}},"qualification":null},{"reference":{"builtinModule":"GHC.Types"},"usedName":{"typeName":{"identifier":"IO"}},"qualification":null}],"fragment":["rmLoggerSet :: LoggerSet -> IO ()","rmLoggerSet (LoggerSet mfile fref arr _)\n  = do let (l, u) = bounds arr\n       fd <- readIORef fref\n       let nums = [l .. u]\n       mapM_ (flushIt fd) nums\n       mapM_ freeIt nums\n       when (isJust mfile) $ close fd\n  where flushIt fd i = flushLog fd (arr ! i)\n        freeIt i\n          = do let (Logger mbuf _ _) = arr ! i\n               takeMVar mbuf >>= freeBuffer"],"instances":[],"language":{"extensions":["BangPatterns","MultiParamTypeClasses","NondecreasingIndentation","ExplicitForAll","PatternGuards"],"isInstance":false}}